
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/script/hero_go.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '06c69/yZBZMrKZIrO4yVjGA', 'hero_go');
// script/hero_go.js

"use strict";

var Input = {};
cc.Class({
  "extends": cc.Component,
  properties: {
    mycamrea: {
      type: cc.Node,
      "default": null
    },
    groundJsNode: {
      type: cc.Node,
      "default": null
    },
    map: null,
    heroPos: null,
    top: {
      type: cc.Node,
      "default": null
    }
  },
  onLoad: function onLoad() {
    var _this = this;

    _this.rect = null;
    _this.fagPoint = null; //设置相机等属性，以及加入的map地图node
    // if(this.camrea == null){
    //
    // }
    // if(this.groundJsNode == null){
    //
    // }
    //人物的基本属性，速度，方向，重力

    this.playing = true; //是否正在游戏中还是在查看背包，查看别的信息时角色不能移动

    this.walk = false;
    this.kit = false;
    this._speed = 200;
    this._speed1 = 200;
    this._speed2 = 300;
    this._kiting = false;

    if (this.heroPos != null) {
      this.node.setPosition(this.heroPos);
    } else {
      this.node.setPosition(cc.v2(0, 0)); //初始位置
    }

    this.state = '';
    this.sp = cc.v2(0, 0); //角色当前移动的方向

    this.heroAnim = this.node.getComponent(cc.Animation); //注册事件监听

    if (cc.director.getPhysicsManager().gravity.y == 0) {
      //未开启重力的键盘监听，没有自由落体
      cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.on_key_down, this); //向系统注册键盘按下事件

      cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.on_key_up, this); //向系统注册键盘抬起事件
    } else {
      //开启重力的键盘监听,有自由落体
      this.herobody = this.node.getComponent(cc.RigidBody); //把刚体保存下来

      this.input_control = 0;
      cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.on_key_down_1, this); //向系统注册键盘按下事件

      cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.on_key_up_1, this); //向系统注册键盘抬起事件
    }
  },
  onCollisionEnter: function onCollisionEnter(other, self) {
    //碰撞开始
    switch (other.tag) {
      case 1001:
        other.node.gotoAndStop(other.node.currentFrame == 1 ? 5 : 1);
        this.groundJs.setYMovieClipFrame(this.groundJs.getTag("a1001"), other.node.currentFrame, false); //setYMovieClipFrame方法是播放制定动画的帧，第一个参数为动画标记，第二个是帧数，第三个是是播放还是跳到该帧就停止

        break;

      case 300:
        this.playing = false;
        game.notice("房间里什么都没有!!去别的房子看看吧", this.node.getPosition());
        break;

      case 501:
        // game.switchMap("map","map3");//切换地图
        cc.director.loadScene("game3"); // this.groundJs.removeAll();

        break;

      case 601:
        // game.switchMap("map3","map");//切换地图
        cc.director.loadScene("game1"); // this.groundJs.removeAll();

        break;

      case 602:
        this.node.setPosition(this.groundJs.getLayerNodeFun("map").p602);
        break;

      case 603:
        this.node.setPosition(this.groundJs.getLayerNodeFun("map").p603);
        break;

      case 604:
        this.node.setPosition(this.groundJs.getLayerNodeFun("map").p604);
        break;
    }
  },
  onCollisionStay: function onCollisionStay(other, self) {//碰撞持续
  },
  kit_end: function kit_end() {
    this._kiting = false;
    this.heroAnim.play(this.state);
  },
  setState: function setState(state) {
    if (this.state == state) return;
    this.state = state;
    if (this._kiting) return;
    this.heroAnim.play(this.state);
  },
  hero_stop: function hero_stop() {
    this.heroAnim.stop(this.state);
  },
  on_player_jump: function on_player_jump() {
    //有自由落体时的跳跃
    var v = this.node.getComponent(cc.RigidBody).linearVelocity;
    v.y = 800;
    this.node.getComponent(cc.RigidBody).linearVelocity = v;
  },
  on_player_walk: function on_player_walk(dir) {
    //有自由落体时的行走
    var v = this.node.getComponent(cc.RigidBody).linearVelocity;
    v.x = 300 * dir;
    this.node.scaleX = dir;
    this.node.getComponent(cc.RigidBody).linearVelocity = v;
  },
  on_key_down_1: function on_key_down_1(e) {
    switch (e.keyCode) {
      case 87:
        this.on_player_jump();
        break;

      case 65:
        this.input_control = -1;
        break;

      case 68:
        this.input_control = 1;
        break;

      case 66:
        this.playing = !this.playing;
        game.openAndClosePackage(this.node.getPosition());
        break;
    }
  },
  on_key_up_1: function on_key_up_1(e) {
    switch (e.keyCode) {
      case 65:
        this.input_control = 0;
        break;

      case 68:
        this.input_control = 0;
        break;
    }
  },
  on_key_down: function on_key_down(e) {
    //w:87  s:83   a:65  d:68  j:74  k:75  l:76  u:85  i:73   o:79  shift:16   l:76   空格：32  q:81
    Input[e.keyCode] = 1;

    switch (e.keyCode) {
      case 76:
        this._speed = this._speed2;
        break;

      case 81:
        game.noticeExit();
        this.playing = true;
        break;

      case 66:
        //打开或关闭背包
        this.playing = !this.playing;
        game.openAndClosePackage(this.node.getPosition());
        break;
    }
  },
  on_key_up: function on_key_up(e) {
    //w:87  s:83   a:65  d:68  j:74  k:75  l:76  u:85  i:73   o:79
    Input[e.keyCode] = 0;
    this.state = '';

    switch (e.keyCode) {
      case 87:
        //上
        this.hero_stop();
        break;

      case 65:
        //左
        this.hero_stop();
        break;

      case 68:
        //右
        this.hero_stop();
        break;

      case 83:
        //下
        this.hero_stop();
        break;

      case 76:
        this._speed = this._speed1;
        break;
    }
  },
  start: function start() {
    this.groundJs = this.groundJsNode.getComponent(this.map);
    this.groundJs.mapCameraNode = this.mycamrea;
    this.topPosheight = this.top.getPosition().y - this.node.getPosition().y; //界面顶部的top信息，等级，经验，头像等
  },
  update: function update(dt) {
    if (this.playing) {
      if (cc.director.getPhysicsManager().gravity.y == 0) {
        if (Input[cc.macro.KEY.d]) {
          this.sp.x = 1;
        } else if (Input[cc.macro.KEY.a]) {
          this.sp.x = -1;
        } else {
          this.sp.x = 0;
        }

        if (Input[cc.macro.KEY.w]) {
          this.sp.y = 1;
        } else if (Input[cc.macro.KEY.s]) {
          this.sp.y = -1;
        } else {
          this.sp.y = 0;
        }

        this.lv = this.node.getComponent(cc.RigidBody).linearVelocity;

        if (this.sp.x) {
          this.lv.y = 0;
          this.lv.x = this.sp.x * this._speed;
        } else if (this.sp.y) {
          this.lv.x = 0;
          this.lv.y = this.sp.y * this._speed;
        } else {
          this.lv.y = 0;
          this.lv.x = 0;
        }

        if (!this._kiting) {
          this.node.getComponent(cc.RigidBody).linearVelocity = this.lv;
        }

        var pp = new cc.v2(this.node.x, this.node.y + this.topPosheight);
        this.top.setPosition(pp);
        var state = '';

        if (this.sp.x == 1) {
          state = "hero_right";
        } else if (this.sp.x == -1) {
          state = "hero_left";
        } else if (this.sp.y == 1) {
          state = "hero_up";
        } else if (this.sp.y == -1) {
          state = "hero_down";
        }

        if (state) {
          this.setState(state);
        }

        if (state && Input[cc.macro.KEY.j]) {
          if (!this._kiting) {
            this._kiting = true;
            this.heroAnim.play(this.state + "_kit");
            this.state = '';
          }
        }
      } else {
        if (this.input_control !== 0) {
          this.on_player_walk(this.input_control);
        }
      }
    }

    if (this.mycamrea !== null) {
      this.mycamrea.x = this.node.x; // if(cc.director.getPhysicsManager().gravity.y == 0){

      this.mycamrea.y = this.node.y; // }

      if (this.fagPonint != null && this.rect != null) {// console.log(this.fagPonint);
        // this.fagPonint.x = this.node.x;
        // this.fagPonint.y = this.node.y;
        // this.rect.x = this.node.x;
        // this.rect.y = this.node.y;
      }
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0XFxoZXJvX2dvLmpzIl0sIm5hbWVzIjpbIklucHV0IiwiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJteWNhbXJlYSIsInR5cGUiLCJOb2RlIiwiZ3JvdW5kSnNOb2RlIiwibWFwIiwiaGVyb1BvcyIsInRvcCIsIm9uTG9hZCIsIl90aGlzIiwicmVjdCIsImZhZ1BvaW50IiwicGxheWluZyIsIndhbGsiLCJraXQiLCJfc3BlZWQiLCJfc3BlZWQxIiwiX3NwZWVkMiIsIl9raXRpbmciLCJub2RlIiwic2V0UG9zaXRpb24iLCJ2MiIsInN0YXRlIiwic3AiLCJoZXJvQW5pbSIsImdldENvbXBvbmVudCIsIkFuaW1hdGlvbiIsImRpcmVjdG9yIiwiZ2V0UGh5c2ljc01hbmFnZXIiLCJncmF2aXR5IiwieSIsInN5c3RlbUV2ZW50Iiwib24iLCJTeXN0ZW1FdmVudCIsIkV2ZW50VHlwZSIsIktFWV9ET1dOIiwib25fa2V5X2Rvd24iLCJLRVlfVVAiLCJvbl9rZXlfdXAiLCJoZXJvYm9keSIsIlJpZ2lkQm9keSIsImlucHV0X2NvbnRyb2wiLCJvbl9rZXlfZG93bl8xIiwib25fa2V5X3VwXzEiLCJvbkNvbGxpc2lvbkVudGVyIiwib3RoZXIiLCJzZWxmIiwidGFnIiwiZ290b0FuZFN0b3AiLCJjdXJyZW50RnJhbWUiLCJncm91bmRKcyIsInNldFlNb3ZpZUNsaXBGcmFtZSIsImdldFRhZyIsImdhbWUiLCJub3RpY2UiLCJnZXRQb3NpdGlvbiIsImxvYWRTY2VuZSIsImdldExheWVyTm9kZUZ1biIsInA2MDIiLCJwNjAzIiwicDYwNCIsIm9uQ29sbGlzaW9uU3RheSIsImtpdF9lbmQiLCJwbGF5Iiwic2V0U3RhdGUiLCJoZXJvX3N0b3AiLCJzdG9wIiwib25fcGxheWVyX2p1bXAiLCJ2IiwibGluZWFyVmVsb2NpdHkiLCJvbl9wbGF5ZXJfd2FsayIsImRpciIsIngiLCJzY2FsZVgiLCJlIiwia2V5Q29kZSIsIm9wZW5BbmRDbG9zZVBhY2thZ2UiLCJub3RpY2VFeGl0Iiwic3RhcnQiLCJtYXBDYW1lcmFOb2RlIiwidG9wUG9zaGVpZ2h0IiwidXBkYXRlIiwiZHQiLCJtYWNybyIsIktFWSIsImQiLCJhIiwidyIsInMiLCJsdiIsInBwIiwiaiIsImZhZ1BvbmludCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFNQSxLQUFLLEdBQUcsRUFBZDtBQUNBQyxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsUUFBUSxFQUFDO0FBQ0xDLE1BQUFBLElBQUksRUFBQ0wsRUFBRSxDQUFDTSxJQURIO0FBRUwsaUJBQVE7QUFGSCxLQUREO0FBS1JDLElBQUFBLFlBQVksRUFBQztBQUNURixNQUFBQSxJQUFJLEVBQUNMLEVBQUUsQ0FBQ00sSUFEQztBQUVULGlCQUFRO0FBRkMsS0FMTDtBQVNSRSxJQUFBQSxHQUFHLEVBQUMsSUFUSTtBQVVSQyxJQUFBQSxPQUFPLEVBQUMsSUFWQTtBQVdSQyxJQUFBQSxHQUFHLEVBQUM7QUFDQUwsTUFBQUEsSUFBSSxFQUFDTCxFQUFFLENBQUNNLElBRFI7QUFFQSxpQkFBUTtBQUZSO0FBWEksR0FIUDtBQW9CTEssRUFBQUEsTUFwQkssb0JBb0JLO0FBQ04sUUFBSUMsS0FBSyxHQUFHLElBQVo7O0FBQ0FBLElBQUFBLEtBQUssQ0FBQ0MsSUFBTixHQUFhLElBQWI7QUFDQUQsSUFBQUEsS0FBSyxDQUFDRSxRQUFOLEdBQWlCLElBQWpCLENBSE0sQ0FJTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBLFNBQUtDLE9BQUwsR0FBZSxJQUFmLENBWk0sQ0FZYzs7QUFDcEIsU0FBS0MsSUFBTCxHQUFZLEtBQVo7QUFDQSxTQUFLQyxHQUFMLEdBQVcsS0FBWDtBQUNBLFNBQUtDLE1BQUwsR0FBYyxHQUFkO0FBQ0EsU0FBS0MsT0FBTCxHQUFlLEdBQWY7QUFDQSxT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QWtCLElBQXJCLEVBQTBCO0FBQ3RCLFdBQUtBLFFBQUwsQ0FBY3VFLENBQWQsR0FBa0IsS0FBS3JELElBQUwsQ0FBVXFELENBQTVCLENBRHNCLENBRXRCOztBQUNJLFdBQUt2RSxRQUFMLENBQWM2QixDQUFkLEdBQWtCLEtBQUtYLElBQUwsQ0FBVVcsQ0FBNUIsQ0FIa0IsQ0FJdEI7O0FBQ0EsVUFBRyxLQUFLOEQsU0FBTCxJQUFrQixJQUFsQixJQUEwQixLQUFLbEYsSUFBTCxJQUFhLElBQTFDLEVBQStDLENBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBRUo7QUFsUkksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgSW5wdXQgPSB7fTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBteWNhbXJlYTp7XHJcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZSxcclxuICAgICAgICAgICAgZGVmYXVsdDpudWxsLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ3JvdW5kSnNOb2RlOntcclxuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlLFxyXG4gICAgICAgICAgICBkZWZhdWx0Om51bGxcclxuICAgICAgICB9LFxyXG4gICAgICAgIG1hcDpudWxsLFxyXG4gICAgICAgIGhlcm9Qb3M6bnVsbCxcclxuICAgICAgICB0b3A6e1xyXG4gICAgICAgICAgICB0eXBlOmNjLk5vZGUsXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbFxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgb25Mb2FkICgpIHtcclxuICAgICAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIF90aGlzLnJlY3QgPSBudWxsO1xyXG4gICAgICAgIF90aGlzLmZhZ1BvaW50ID0gbnVsbDtcclxuICAgICAgICAvL+iuvue9ruebuOacuuetieWxnuaAp++8jOS7peWPiuWKoOWFpeeahG1hcOWcsOWbvm5vZGVcclxuICAgICAgICAvLyBpZih0aGlzLmNhbXJlYSA9PSBudWxsKXtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIH1cclxuICAgICAgICAvLyBpZih0aGlzLmdyb3VuZEpzTm9kZSA9PSBudWxsKXtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIH1cclxuICAgICAgICAvL+S6uueJqeeahOWfuuacrOWxnuaAp++8jOmAn+W6pu+8jOaWueWQke+8jOmHjeWKm1xyXG4gICAgICAgIHRoaXMucGxheWluZyA9IHRydWU7Ly/mmK/lkKbmraPlnKjmuLjmiI/kuK3ov5jmmK/lnKjmn6XnnIvog4zljIXvvIzmn6XnnIvliKvnmoTkv6Hmga/ml7bop5LoibLkuI3og73np7vliqhcclxuICAgICAgICB0aGlzLndhbGsgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmtpdCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3NwZWVkID0gMjAwO1xyXG4gICAgICAgIHRoaXMuX3NwZWVkMSA9IDIwMDtcclxuICAgICAgICB0aGlzLl9zcGVlZDIgPSAzMDA7XHJcbiAgICAgICAgdGhpcy5fa2l0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgaWYodGhpcy5oZXJvUG9zICE9IG51bGwpe1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuc2V0UG9zaXRpb24odGhpcy5oZXJvUG9zKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLnNldFBvc2l0aW9uKGNjLnYyKDAsMCkpOy8v5Yid5aeL5L2N572uXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc3RhdGUgPSAnJztcclxuICAgICAgICB0aGlzLnNwID0gY2MudjIoMCwwKTsgIC8v6KeS6Imy5b2T5YmN56e75Yqo55qE5pa55ZCRXHJcbiAgICAgICAgdGhpcy5oZXJvQW5pbSA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcclxuXHJcbiAgICAgICAgLy/ms6jlhozkuovku7bnm5HlkKxcclxuICAgICAgICBpZihjYy5kaXJlY3Rvci5nZXRQaHlzaWNzTWFuYWdlcigpLmdyYXZpdHkueSA9PSAwKXsvL+acquW8gOWQr+mHjeWKm+eahOmUruebmOebkeWQrO+8jOayoeacieiHqueUseiQveS9k1xyXG4gICAgICAgICAgICBjYy5zeXN0ZW1FdmVudC5vbihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX0RPV04sdGhpcy5vbl9rZXlfZG93bix0aGlzKTsvL+WQkeezu+e7n+azqOWGjOmUruebmOaMieS4i+S6i+S7tlxyXG4gICAgICAgICAgICBjYy5zeXN0ZW1FdmVudC5vbihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX1VQLHRoaXMub25fa2V5X3VwLHRoaXMpOy8v5ZCR57O757uf5rOo5YaM6ZSu55uY5oqs6LW35LqL5Lu2XHJcbiAgICAgICAgfWVsc2V7Ly/lvIDlkK/ph43lipvnmoTplK7nm5jnm5HlkKws5pyJ6Ieq55Sx6JC95L2TXHJcbiAgICAgICAgICAgIHRoaXMuaGVyb2JvZHkgPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KGNjLlJpZ2lkQm9keSk7Ly/miorliJrkvZPkv53lrZjkuIvmnaVcclxuICAgICAgICAgICAgdGhpcy5pbnB1dF9jb250cm9sID0gMDtcclxuICAgICAgICAgICAgY2Muc3lzdGVtRXZlbnQub24oY2MuU3lzdGVtRXZlbnQuRXZlbnRUeXBlLktFWV9ET1dOLHRoaXMub25fa2V5X2Rvd25fMSx0aGlzKTsvL+WQkeezu+e7n+azqOWGjOmUruebmOaMieS4i+S6i+S7tlxyXG4gICAgICAgICAgICBjYy5zeXN0ZW1FdmVudC5vbihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX1VQLHRoaXMub25fa2V5X3VwXzEsdGhpcyk7Ly/lkJHns7vnu5/ms6jlhozplK7nm5jmiqzotbfkuovku7ZcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBvbkNvbGxpc2lvbkVudGVyOmZ1bmN0aW9uKG90aGVyICwgc2VsZil7IC8v56Kw5pKe5byA5aeLXHJcbiAgICAgICAgc3dpdGNoIChvdGhlci50YWcpIHtcclxuICAgICAgICAgICAgY2FzZSAxMDAxOlxyXG4gICAgICAgICAgICAgICAgb3RoZXIubm9kZS5nb3RvQW5kU3RvcChvdGhlci5ub2RlLmN1cnJlbnRGcmFtZT09MT81OjEpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncm91bmRKcy5zZXRZTW92aWVDbGlwRnJhbWUodGhpcy5ncm91bmRKcy5nZXRUYWcoXCJhMTAwMVwiKSxvdGhlci5ub2RlLmN1cnJlbnRGcmFtZSxmYWxzZSk7Ly9zZXRZTW92aWVDbGlwRnJhbWXmlrnms5XmmK/mkq3mlL7liLblrprliqjnlLvnmoTluKfvvIznrKzkuIDkuKrlj4LmlbDkuLrliqjnlLvmoIforrDvvIznrKzkuozkuKrmmK/luKfmlbDvvIznrKzkuInkuKrmmK/mmK/mkq3mlL7ov5jmmK/ot7PliLDor6XluKflsLHlgZzmraJcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDMwMDpcclxuICAgICAgICAgICAgICAgIHRoaXMucGxheWluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgZ2FtZS5ub3RpY2UoXCLmiL/pl7Tph4zku4DkuYjpg73msqHmnIkhIeWOu+WIq+eahOaIv+WtkOeci+eci+WQp1wiLHRoaXMubm9kZS5nZXRQb3NpdGlvbigpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDUwMTpcclxuICAgICAgICAgICAgICAgIC8vIGdhbWUuc3dpdGNoTWFwKFwibWFwXCIsXCJtYXAzXCIpOy8v5YiH5o2i5Zyw5Zu+XHJcbiAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJnYW1lM1wiKTtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuZ3JvdW5kSnMucmVtb3ZlQWxsKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA2MDE6XHJcbiAgICAgICAgICAgICAgICAvLyBnYW1lLnN3aXRjaE1hcChcIm1hcDNcIixcIm1hcFwiKTsvL+WIh+aNouWcsOWbvlxyXG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwiZ2FtZTFcIik7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLmdyb3VuZEpzLnJlbW92ZUFsbCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNjAyOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLnNldFBvc2l0aW9uKHRoaXMuZ3JvdW5kSnMuZ2V0TGF5ZXJOb2RlRnVuKFwibWFwXCIpLnA2MDIpXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA2MDM6XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuc2V0UG9zaXRpb24odGhpcy5ncm91bmRKcy5nZXRMYXllck5vZGVGdW4oXCJtYXBcIikucDYwMylcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDYwNDpcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5zZXRQb3NpdGlvbih0aGlzLmdyb3VuZEpzLmdldExheWVyTm9kZUZ1bihcIm1hcFwiKS5wNjA0KVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uQ29sbGlzaW9uU3RheTogZnVuY3Rpb24gKG90aGVyLCBzZWxmKSB7ICAvL+eisOaSnuaMgee7rVxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICBraXRfZW5kKCl7XHJcbiAgICAgICAgdGhpcy5fa2l0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5oZXJvQW5pbS5wbGF5KHRoaXMuc3RhdGUpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRTdGF0ZShzdGF0ZSl7XHJcbiAgICAgICAgaWYodGhpcy5zdGF0ZSA9PSBzdGF0ZSlyZXR1cm47XHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICBpZih0aGlzLl9raXRpbmcpcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuaGVyb0FuaW0ucGxheSh0aGlzLnN0YXRlKTtcclxuICAgIH0sXHJcblxyXG4gICAgaGVyb19zdG9wKCl7XHJcbiAgICAgICAgdGhpcy5oZXJvQW5pbS5zdG9wKHRoaXMuc3RhdGUpO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbl9wbGF5ZXJfanVtcCgpey8v5pyJ6Ieq55Sx6JC95L2T5pe255qE6Lez6LeDXHJcbiAgICAgICAgdmFyIHYgPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KGNjLlJpZ2lkQm9keSkubGluZWFyVmVsb2NpdHk7XHJcbiAgICAgICAgdi55ID0gODAwO1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuUmlnaWRCb2R5KS5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uX3BsYXllcl93YWxrKGRpcil7Ly/mnInoh6rnlLHokL3kvZPml7bnmoTooYzotbBcclxuICAgICAgICB2YXIgdiA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuUmlnaWRCb2R5KS5saW5lYXJWZWxvY2l0eTtcclxuICAgICAgICB2LnggPSAoMzAwICogZGlyKTtcclxuICAgICAgICB0aGlzLm5vZGUuc2NhbGVYID0gZGlyO1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuUmlnaWRCb2R5KS5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uX2tleV9kb3duXzEoZSl7XHJcbiAgICAgICAgc3dpdGNoKGUua2V5Q29kZSl7XHJcbiAgICAgICAgICAgIGNhc2UgODc6XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uX3BsYXllcl9qdW1wKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA2NTpcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRfY29udHJvbCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNjg6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0X2NvbnRyb2wgPSAxO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNjY6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXlpbmcgPSAhdGhpcy5wbGF5aW5nO1xyXG4gICAgICAgICAgICAgICAgZ2FtZS5vcGVuQW5kQ2xvc2VQYWNrYWdlKHRoaXMubm9kZS5nZXRQb3NpdGlvbigpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbl9rZXlfdXBfMShlKXtcclxuICAgICAgICBzd2l0Y2goZS5rZXlDb2RlKXtcclxuICAgICAgICAgICAgY2FzZSA2NTpcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRfY29udHJvbCA9IDA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA2ODpcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRfY29udHJvbCA9IDA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIG9uX2tleV9kb3duKGUpeyAgICAgICAgICAgLy93Ojg3ICBzOjgzICAgYTo2NSAgZDo2OCAgajo3NCAgazo3NSAgbDo3NiAgdTo4NSAgaTo3MyAgIG86NzkgIHNoaWZ0OjE2ICAgbDo3NiAgIOepuuagvO+8mjMyICBxOjgxXHJcbiAgICAgICAgSW5wdXRbZS5rZXlDb2RlXT0xO1xyXG4gICAgICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgNzY6XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zcGVlZCA9IHRoaXMuX3NwZWVkMjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDgxOlxyXG4gICAgICAgICAgICAgICAgZ2FtZS5ub3RpY2VFeGl0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXlpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNjY6ICAgLy/miZPlvIDmiJblhbPpl63og4zljIVcclxuICAgICAgICAgICAgICAgIHRoaXMucGxheWluZyA9ICF0aGlzLnBsYXlpbmc7XHJcbiAgICAgICAgICAgICAgICBnYW1lLm9wZW5BbmRDbG9zZVBhY2thZ2UodGhpcy5ub2RlLmdldFBvc2l0aW9uKCkpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uX2tleV91cChlKXsgICAgICAgIC8vdzo4NyAgczo4MyAgIGE6NjUgIGQ6NjggIGo6NzQgIGs6NzUgIGw6NzYgIHU6ODUgIGk6NzMgICBvOjc5XHJcbiAgICAgICAgSW5wdXRbZS5rZXlDb2RlXT0wO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSAnJztcclxuICAgICAgICBzd2l0Y2goZS5rZXlDb2RlKXtcclxuICAgICAgICAgICAgY2FzZSA4NzogIC8v5LiKXHJcbiAgICAgICAgICAgICAgICB0aGlzLmhlcm9fc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNjU6ICAvL+W3plxyXG4gICAgICAgICAgICAgICAgdGhpcy5oZXJvX3N0b3AoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDY4OiAgIC8v5Y+zXHJcbiAgICAgICAgICAgICAgICB0aGlzLmhlcm9fc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgODM6ICAgLy/kuItcclxuICAgICAgICAgICAgICAgIHRoaXMuaGVyb19zdG9wKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA3NjpcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NwZWVkID0gdGhpcy5fc3BlZWQxO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBzdGFydCAoKSB7XHJcbiAgICAgICAgdGhpcy5ncm91bmRKcyA9IHRoaXMuZ3JvdW5kSnNOb2RlLmdldENvbXBvbmVudCh0aGlzLm1hcCk7XHJcbiAgICAgICAgdGhpcy5ncm91bmRKcy5tYXBDYW1lcmFOb2RlID0gdGhpcy5teWNhbXJlYTtcclxuXHJcbiAgICAgICAgdGhpcy50b3BQb3NoZWlnaHQgPSB0aGlzLnRvcC5nZXRQb3NpdGlvbigpLnkgLSB0aGlzLm5vZGUuZ2V0UG9zaXRpb24oKS55Oy8v55WM6Z2i6aG26YOo55qEdG9w5L+h5oGv77yM562J57qn77yM57uP6aqM77yM5aS05YOP562JXHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZSAoZHQpIHtcclxuICAgICAgICBpZih0aGlzLnBsYXlpbmcpe1xyXG4gICAgICAgICAgICBpZihjYy5kaXJlY3Rvci5nZXRQaHlzaWNzTWFuYWdlcigpLmdyYXZpdHkueSA9PSAwKXtcclxuICAgICAgICAgICAgICAgIGlmKElucHV0W2NjLm1hY3JvLktFWS5kXSl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcC54ID0gMTtcclxuICAgICAgICAgICAgICAgIH1lbHNlIGlmKElucHV0W2NjLm1hY3JvLktFWS5hXSl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcC54ID0gLTE7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNwLnggPSAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYoSW5wdXRbY2MubWFjcm8uS0VZLnddKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNwLnkgPSAxO1xyXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYoSW5wdXRbY2MubWFjcm8uS0VZLnNdKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNwLnkgPSAtMTtcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3AueSA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5sdiA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuUmlnaWRCb2R5KS5saW5lYXJWZWxvY2l0eTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLnNwLngpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubHYueSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sdi54ID0gdGhpcy5zcC54ICogdGhpcy5fc3BlZWQ7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZih0aGlzLnNwLnkpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubHYueCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sdi55ID0gdGhpcy5zcC55ICogdGhpcy5fc3BlZWQ7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmx2LnkgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubHYueCA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZighdGhpcy5fa2l0aW5nKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KGNjLlJpZ2lkQm9keSkubGluZWFyVmVsb2NpdHkgPSB0aGlzLmx2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IHBwID0gbmV3IGNjLnYyKHRoaXMubm9kZS54LHRoaXMubm9kZS55ICt0aGlzLnRvcFBvc2hlaWdodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvcC5zZXRQb3NpdGlvbihwcCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3RhdGUgPSAnJztcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuc3AueCA9PSAxKXtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IFwiaGVyb19yaWdodFwiO1xyXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYodGhpcy5zcC54ID09IC0xKXtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IFwiaGVyb19sZWZ0XCI7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZih0aGlzLnNwLnkgPT0gMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBcImhlcm9fdXBcIjtcclxuICAgICAgICAgICAgICAgIH1lbHNlIGlmKHRoaXMuc3AueSA9PSAtMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBcImhlcm9fZG93blwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYoc3RhdGUpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYoc3RhdGUgJiYgSW5wdXRbY2MubWFjcm8uS0VZLmpdKXtcclxuICAgICAgICAgICAgICAgICAgICBpZighdGhpcy5fa2l0aW5nKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2l0aW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oZXJvQW5pbS5wbGF5KHRoaXMuc3RhdGUrXCJfa2l0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuaW5wdXRfY29udHJvbCAhPT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbl9wbGF5ZXJfd2Fsayh0aGlzLmlucHV0X2NvbnRyb2wpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZih0aGlzLm15Y2FtcmVhICE9PSBudWxsKXtcclxuICAgICAgICAgICAgdGhpcy5teWNhbXJlYS54ID0gdGhpcy5ub2RlLng7XHJcbiAgICAgICAgICAgIC8vIGlmKGNjLmRpcmVjdG9yLmdldFBoeXNpY3NNYW5hZ2VyKCkuZ3Jhdml0eS55ID09IDApe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5teWNhbXJlYS55ID0gdGhpcy5ub2RlLnk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgaWYodGhpcy5mYWdQb25pbnQgIT0gbnVsbCAmJiB0aGlzLnJlY3QgIT0gbnVsbCl7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmZhZ1BvbmludCk7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLmZhZ1BvbmludC54ID0gdGhpcy5ub2RlLng7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLmZhZ1BvbmludC55ID0gdGhpcy5ub2RlLnk7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLnJlY3QueCA9IHRoaXMubm9kZS54O1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5yZWN0LnkgPSB0aGlzLm5vZGUueTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG59KTtcclxuIl19