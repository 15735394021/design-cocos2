
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/script/hero_go.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '06c69/yZBZMrKZIrO4yVjGA', 'hero_go');
// script/hero_go.js

"use strict";

var Input = {};
cc.Class({
  "extends": cc.Component,
  properties: {
    mycamrea: {
      type: cc.Node,
      "default": null
    },
    groundJsNode: {
      type: cc.Node,
      "default": null
    }
  },
  onLoad: function onLoad() {
    window.hero_go = this;
    this.groundJs = this.groundJsNode.getComponent("ground2");

    var _this = this;

    _this.rect = null;
    _this.fagPoint = null; //设置相机等属性，以及加入的map地图node
    // if(this.camrea == null){
    //
    // }
    // if(this.groundJsNode == null){
    //
    // }
    //人物的基本属性，速度，方向，重力

    this.playing = true; //是否正在游戏中还是在查看背包，查看别的信息时角色不能移动

    this.walk = false;
    this.kit = false;
    this._speed = 200;
    this._speed1 = 200;
    this._speed2 = 300;
    this._kiting = false;
    this.state = '';
    this.sp = cc.v2(0, 0); //角色当前移动的方向

    this.heroAnim = this.node.getComponent(cc.Animation); // let p = cc.director.getPhysicsManager();    //得到物理组件
    // p.enabled = true;  //启用物理引擎
    // p.debugDrawFlags = true;  //显示出来碰撞边框，为了方便演示
    // cc.director.getCollisionManager().enabled = true; //检测碰撞
    // cc.director.getCollisionManager().enabledDebugDraw = true;//碰撞检测的边框显示
    // p.gravity = cc.v2(0,0);    //关闭重力
    //注册事件监听

    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.on_key_down, this); //向系统注册键盘按下事件

    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.on_key_up, this); //向系统注册键盘抬起事件
  },
  onCollisionEnter: function onCollisionEnter(other, self) {
    //碰撞开始
    if (other.tag == 1001) {
      other.node.gotoAndStop(other.node.currentFrame == 1 ? 5 : 1);
      this.groundJs.setYMovieClipFrame(this.groundJs.getTag("a1001"), other.node.currentFrame, false); //setYMovieClipFrame方法是播放制定动画的帧，第一个参数为动画标记，第二个是帧数，第三个是是播放还是跳到该帧就停止
    }

    if (other.tag == 2001) {
      this.groundJs.getLayerNodeFun("house").parent = this.groundJsNode;
      this.node.parent = this.groundJs.getLayerNodeFun("hero");
      this.groundJs.getLayerNodeFun("map").parent = null;
      this.groundJs.getLayerNodeFun("ground").parent = null;
    }

    if (other.tag == 300) {
      this.playing = false;
      game.notice("房间里什么都没有!!去别的房子看看吧", this.node.x, this.node.y);
    }

    if (other.tag == 501) {
      console.log("跨越第一个地图");
    }
  },
  onCollisionStay: function onCollisionStay(other, self) {//碰撞持续
  },
  kit_end: function kit_end() {
    this._kiting = false;
    this.heroAnim.play(this.state);
    d;
  },
  setState: function setState(state) {
    if (this.state == state) return;
    this.state = state;
    if (this._kiting) return;
    this.heroAnim.play(this.state);
  },
  hero_stop: function hero_stop() {
    this.heroAnim.stop(this.state);
  },
  on_key_down: function on_key_down(e) {
    //w:87  s:83   a:65  d:68  j:74  k:75  l:76  u:85  i:73   o:79  shift:16   l:76   空格：32  q:81
    Input[e.keyCode] = 1;

    if (e.keyCode == 76) {
      this._speed = this._speed2;
    }

    if (e.keyCode == 81) {
      game.noticeExit();
      this.playing = true;
    }
  },
  on_key_up: function on_key_up(e) {
    //w:87  s:83   a:65  d:68  j:74  k:75  l:76  u:85  i:73   o:79
    Input[e.keyCode] = 0;
    this.state = '';

    switch (e.keyCode) {
      case 87:
        //上
        this.hero_stop();
        break;

      case 65:
        //左
        this.hero_stop();
        break;

      case 68:
        //右
        this.hero_stop();
        break;

      case 83:
        //下
        this.hero_stop();
        break;

      case 76:
        this._speed = this._speed1;
        break;
    }
  },
  start: function start() {},
  update: function update(dt) {
    if (this.playing) {
      if (Input[cc.macro.KEY.d]) {
        this.sp.x = 1;
      } else if (Input[cc.macro.KEY.a]) {
        this.sp.x = -1;
      } else {
        this.sp.x = 0;
      }

      if (Input[cc.macro.KEY.w]) {
        this.sp.y = 1;
      } else if (Input[cc.macro.KEY.s]) {
        this.sp.y = -1;
      } else {
        this.sp.y = 0;
      }

      this.lv = this.node.getComponent(cc.RigidBody).linearVelocity;

      if (this.sp.x) {
        this.lv.y = 0;
        this.lv.x = this.sp.x * this._speed;
      } else if (this.sp.y) {
        this.lv.x = 0;
        this.lv.y = this.sp.y * this._speed;
      } else {
        this.lv.y = 0;
        this.lv.x = 0;
      }

      this.node.getComponent(cc.RigidBody).linearVelocity = this.lv;
      var state = '';

      if (this.sp.x == 1) {
        state = "hero_right";
      } else if (this.sp.x == -1) {
        state = "hero_left";
      } else if (this.sp.y == 1) {
        state = "hero_up";
      } else if (this.sp.y == -1) {
        state = "hero_down";
      }

      if (state) {
        this.setState(state);
      }

      if (state && Input[cc.macro.KEY.j]) {
        if (!this._kiting) {
          this._kiting = true;
          this.heroAnim.play(this.state + "_kit");
          this.state = '';
        }
      }
    }

    if (this.mycamrea !== null) {
      this.mycamrea.x = this.node.x;
      this.mycamrea.y = this.node.y;

      if (this.fagPonint != null && this.rect != null) {// console.log(this.fagPonint);
        // this.fagPonint.x = this.node.x;
        // this.fagPonint.y = this.node.y;
        // this.rect.x = this.node.x;
        // this.rect.y = this.node.y;
      }
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0XFxoZXJvX2dvLmpzIl0sIm5hbWVzIjpbIklucHV0IiwiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJteWNhbXJlYSIsInR5cGUiLCJOb2RlIiwiZ3JvdW5kSnNOb2RlIiwib25Mb2FkIiwid2luZG93IiwiaGVyb19nbyIsImdyb3VuZEpzIiwiZ2V0Q29tcG9uZW50IiwiX3RoaXMiLCJyZWN0IiwiZmFnUG9pbnQiLCJwbGF5aW5nIiwid2FsayIsImtpdCIsIl9zcGVlZCIsIl9zcGVlZDEiLCJfc3BlZWQyIiwiX2tpdGluZyIsInN0YXRlIiwic3AiLCJ2MiIsImhlcm9BbmltIiwibm9kZSIsIkFuaW1hdGlvbiIsInN5c3RlbUV2ZW50Iiwib24iLCJTeXN0ZW1FdmVudCIsIkV2ZW50VHlwZSIsIktFWV9ET1dOIiwib25fa2V5X2Rvd24iLCJLRVlfVVAiLCJvbl9rZXlfdXAiLCJvbkNvbGxpc2lvbkVudGVyIiwib3RoZXIiLCJzZWxmIiwidGFnIiwiZ290b0FuZFN0b3AiLCJjdXJyZW50RnJhbWUiLCJzZXRZTW92aWVDbGlwRnJhbWUiLCJnZXRUYWciLCJnZXRMYXllck5vZGVGdW4iLCJwYXJlbnQiLCJnYW1lIiwibm90aWNlIiwieCIsInkiLCJjb25zb2xlIiwibG9nIiwib25Db2xsaXNpb25TdGF5Iiwia2l0X2VuZCIsInBsYXkiLCJkIiwic2V0U3RhdGUiLCJoZXJvX3N0b3AiLCJzdG9wIiwiZSIsImtleUNvZGUiLCJub3RpY2VFeGl0Iiwic3RhcnQiLCJ1cGRhdGUiLCJkdCIsIm1hY3JvIiwiS0VZIiwiYSIsInciLCJzIiwibHYiLCJSaWdpZEJvZHkiLCJsaW5lYXJWZWxvY2l0eSIsImoiLCJmYWdQb25pbnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBTUEsS0FBSyxHQUFHLEVBQWQ7QUFDQUMsRUFBRSxDQUFDQyxLQUFILENBQVM7QUFDTCxhQUFTRCxFQUFFLENBQUNFLFNBRFA7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Q0FBNUI7QUFDQSxXQUFLN0MsUUFBTCxDQUFjOEMsQ0FBZCxHQUFrQixLQUFLdkIsSUFBTCxDQUFVdUIsQ0FBNUI7O0FBQ0EsVUFBRyxLQUFLeUIsU0FBTCxJQUFrQixJQUFsQixJQUEwQixLQUFLN0QsSUFBTCxJQUFhLElBQTFDLEVBQStDLENBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBRUo7QUE3TEksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgSW5wdXQgPSB7fTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBteWNhbXJlYTp7XHJcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZSxcclxuICAgICAgICAgICAgZGVmYXVsdDpudWxsLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ3JvdW5kSnNOb2RlOntcclxuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlLFxyXG4gICAgICAgICAgICBkZWZhdWx0Om51bGxcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZCAoKSB7XHJcbiAgICAgICAgd2luZG93Lmhlcm9fZ28gPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuZ3JvdW5kSnMgPSB0aGlzLmdyb3VuZEpzTm9kZS5nZXRDb21wb25lbnQoXCJncm91bmQyXCIpO1xyXG4gICAgICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgX3RoaXMucmVjdCA9IG51bGw7XHJcbiAgICAgICAgX3RoaXMuZmFnUG9pbnQgPSBudWxsO1xyXG4gICAgICAgIC8v6K6+572u55u45py6562J5bGe5oCn77yM5Lul5Y+K5Yqg5YWl55qEbWFw5Zyw5Zu+bm9kZVxyXG4gICAgICAgIC8vIGlmKHRoaXMuY2FtcmVhID09IG51bGwpe1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIC8vIGlmKHRoaXMuZ3JvdW5kSnNOb2RlID09IG51bGwpe1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIC8v5Lq654mp55qE5Z+65pys5bGe5oCn77yM6YCf5bqm77yM5pa55ZCR77yM6YeN5YqbXHJcbiAgICAgICAgdGhpcy5wbGF5aW5nID0gdHJ1ZTsvL+aYr+WQpuato+WcqOa4uOaIj+S4rei/mOaYr+WcqOafpeeci+iDjOWMhe+8jOafpeeci+WIq+eahOS/oeaBr+aXtuinkuiJsuS4jeiDveenu+WKqFxyXG4gICAgICAgIHRoaXMud2FsayA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMua2l0ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fc3BlZWQgPSAyMDA7XHJcbiAgICAgICAgdGhpcy5fc3BlZWQxID0gMjAwO1xyXG4gICAgICAgIHRoaXMuX3NwZWVkMiA9IDMwMDtcclxuICAgICAgICB0aGlzLl9raXRpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnN0YXRlID0gJyc7XHJcbiAgICAgICAgdGhpcy5zcCA9IGNjLnYyKDAsMCk7ICAvL+inkuiJsuW9k+WJjeenu+WKqOeahOaWueWQkVxyXG4gICAgICAgIHRoaXMuaGVyb0FuaW0gPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgLy8gbGV0IHAgPSBjYy5kaXJlY3Rvci5nZXRQaHlzaWNzTWFuYWdlcigpOyAgICAvL+W+l+WIsOeJqeeQhue7hOS7tlxyXG4gICAgICAgIC8vIHAuZW5hYmxlZCA9IHRydWU7ICAvL+WQr+eUqOeJqeeQhuW8leaTjlxyXG4gICAgICAgIC8vIHAuZGVidWdEcmF3RmxhZ3MgPSB0cnVlOyAgLy/mmL7npLrlh7rmnaXnorDmkp7ovrnmoYbvvIzkuLrkuobmlrnkvr/mvJTnpLpcclxuICAgICAgICAvLyBjYy5kaXJlY3Rvci5nZXRDb2xsaXNpb25NYW5hZ2VyKCkuZW5hYmxlZCA9IHRydWU7IC8v5qOA5rWL56Kw5pKeXHJcbiAgICAgICAgLy8gY2MuZGlyZWN0b3IuZ2V0Q29sbGlzaW9uTWFuYWdlcigpLmVuYWJsZWREZWJ1Z0RyYXcgPSB0cnVlOy8v56Kw5pKe5qOA5rWL55qE6L655qGG5pi+56S6XHJcbiAgICAgICAgLy8gcC5ncmF2aXR5ID0gY2MudjIoMCwwKTsgICAgLy/lhbPpl63ph43liptcclxuXHJcbiAgICAgICAgLy/ms6jlhozkuovku7bnm5HlkKxcclxuICAgICAgICBjYy5zeXN0ZW1FdmVudC5vbihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX0RPV04sdGhpcy5vbl9rZXlfZG93bix0aGlzKTsvL+WQkeezu+e7n+azqOWGjOmUruebmOaMieS4i+S6i+S7tlxyXG4gICAgICAgIGNjLnN5c3RlbUV2ZW50Lm9uKGNjLlN5c3RlbUV2ZW50LkV2ZW50VHlwZS5LRVlfVVAsdGhpcy5vbl9rZXlfdXAsdGhpcyk7Ly/lkJHns7vnu5/ms6jlhozplK7nm5jmiqzotbfkuovku7ZcclxuICAgICAgICBcclxuICAgIH0sXHJcblxyXG4gICAgb25Db2xsaXNpb25FbnRlcjpmdW5jdGlvbihvdGhlciAsIHNlbGYpeyAvL+eisOaSnuW8gOWni1xyXG4gICAgICAgIGlmKG90aGVyLnRhZyA9PSAxMDAxKXtcclxuICAgICAgICAgICAgb3RoZXIubm9kZS5nb3RvQW5kU3RvcChvdGhlci5ub2RlLmN1cnJlbnRGcmFtZT09MT81OjEpO1xyXG4gICAgICAgICAgICB0aGlzLmdyb3VuZEpzLnNldFlNb3ZpZUNsaXBGcmFtZSh0aGlzLmdyb3VuZEpzLmdldFRhZyhcImExMDAxXCIpLG90aGVyLm5vZGUuY3VycmVudEZyYW1lLGZhbHNlKTsvL3NldFlNb3ZpZUNsaXBGcmFtZeaWueazleaYr+aSreaUvuWItuWumuWKqOeUu+eahOW4p++8jOesrOS4gOS4quWPguaVsOS4uuWKqOeUu+agh+iusO+8jOesrOS6jOS4quaYr+W4p+aVsO+8jOesrOS4ieS4quaYr+aYr+aSreaUvui/mOaYr+i3s+WIsOivpeW4p+WwseWBnOatolxyXG4gICAgICAgIH1cclxuICAgICAgICBpZihvdGhlci50YWcgPT0gMjAwMSl7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JvdW5kSnMuZ2V0TGF5ZXJOb2RlRnVuKFwiaG91c2VcIikucGFyZW50ID0gdGhpcy5ncm91bmRKc05vZGU7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5wYXJlbnQgPSB0aGlzLmdyb3VuZEpzLmdldExheWVyTm9kZUZ1bihcImhlcm9cIik7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JvdW5kSnMuZ2V0TGF5ZXJOb2RlRnVuKFwibWFwXCIpLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JvdW5kSnMuZ2V0TGF5ZXJOb2RlRnVuKFwiZ3JvdW5kXCIpLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKG90aGVyLnRhZyA9PSAzMDApe1xyXG4gICAgICAgICAgICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgZ2FtZS5ub3RpY2UoXCLmiL/pl7Tph4zku4DkuYjpg73msqHmnIkhIeWOu+WIq+eahOaIv+WtkOeci+eci+WQp1wiLHRoaXMubm9kZS54LHRoaXMubm9kZS55KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYob3RoZXIudGFnID09IDUwMSl7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi6Leo6LaK56ys5LiA5Liq5Zyw5Zu+XCIpXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uQ29sbGlzaW9uU3RheTogZnVuY3Rpb24gKG90aGVyLCBzZWxmKSB7ICAvL+eisOaSnuaMgee7rVxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICBraXRfZW5kKCl7XHJcbiAgICAgICAgdGhpcy5fa2l0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5oZXJvQW5pbS5wbGF5KHRoaXMuc3RhdGUpO2RcclxuICAgIH0sXHJcblxyXG4gICAgc2V0U3RhdGUoc3RhdGUpe1xyXG4gICAgICAgIGlmKHRoaXMuc3RhdGUgPT0gc3RhdGUpcmV0dXJuO1xyXG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gc3RhdGU7XHJcbiAgICAgICAgaWYodGhpcy5fa2l0aW5nKXJldHVybjtcclxuICAgICAgICB0aGlzLmhlcm9BbmltLnBsYXkodGhpcy5zdGF0ZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGhlcm9fc3RvcCgpe1xyXG4gICAgICAgIHRoaXMuaGVyb0FuaW0uc3RvcCh0aGlzLnN0YXRlKTtcclxuICAgIH0sXHJcbiAgICBvbl9rZXlfZG93bihlKXsgICAgICAgICAgIC8vdzo4NyAgczo4MyAgIGE6NjUgIGQ6NjggIGo6NzQgIGs6NzUgIGw6NzYgIHU6ODUgIGk6NzMgICBvOjc5ICBzaGlmdDoxNiAgIGw6NzYgICDnqbrmoLzvvJozMiAgcTo4MVxyXG4gICAgICAgIElucHV0W2Uua2V5Q29kZV09MTtcclxuICAgICAgICBpZihlLmtleUNvZGUgPT0gNzYpe1xyXG4gICAgICAgICAgICB0aGlzLl9zcGVlZCA9IHRoaXMuX3NwZWVkMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoZS5rZXlDb2RlID09IDgxKXtcclxuICAgICAgICAgICAgZ2FtZS5ub3RpY2VFeGl0KCk7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWluZyA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uX2tleV91cChlKXsgICAgICAgIC8vdzo4NyAgczo4MyAgIGE6NjUgIGQ6NjggIGo6NzQgIGs6NzUgIGw6NzYgIHU6ODUgIGk6NzMgICBvOjc5XHJcbiAgICAgICAgSW5wdXRbZS5rZXlDb2RlXT0wO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSAnJztcclxuICAgICAgICBzd2l0Y2goZS5rZXlDb2RlKXtcclxuICAgICAgICAgICAgY2FzZSA4NzogIC8v5LiKXHJcbiAgICAgICAgICAgICAgICB0aGlzLmhlcm9fc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNjU6ICAvL+W3plxyXG4gICAgICAgICAgICAgICAgdGhpcy5oZXJvX3N0b3AoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDY4OiAgIC8v5Y+zXHJcbiAgICAgICAgICAgICAgICB0aGlzLmhlcm9fc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgODM6ICAgLy/kuItcclxuICAgICAgICAgICAgICAgIHRoaXMuaGVyb19zdG9wKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA3NjpcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NwZWVkID0gdGhpcy5fc3BlZWQxO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBzdGFydCAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGUgKGR0KSB7XHJcbiAgICAgICAgaWYodGhpcy5wbGF5aW5nKXtcclxuICAgICAgICAgICAgaWYoSW5wdXRbY2MubWFjcm8uS0VZLmRdKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3AueCA9IDE7XHJcbiAgICAgICAgICAgIH1lbHNlIGlmKElucHV0W2NjLm1hY3JvLktFWS5hXSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNwLnggPSAtMTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNwLnggPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKElucHV0W2NjLm1hY3JvLktFWS53XSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNwLnkgPSAxO1xyXG4gICAgICAgICAgICB9ZWxzZSBpZihJbnB1dFtjYy5tYWNyby5LRVkuc10pe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zcC55ID0gLTE7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zcC55ID0gMDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5sdiA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuUmlnaWRCb2R5KS5saW5lYXJWZWxvY2l0eTtcclxuXHJcbiAgICAgICAgICAgIGlmKHRoaXMuc3AueCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmx2LnkgPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sdi54ID0gdGhpcy5zcC54ICogdGhpcy5fc3BlZWQ7XHJcbiAgICAgICAgICAgIH1lbHNlIGlmKHRoaXMuc3AueSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmx2LnggPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sdi55ID0gdGhpcy5zcC55ICogdGhpcy5fc3BlZWQ7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sdi55ID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMubHYueCA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChjYy5SaWdpZEJvZHkpLmxpbmVhclZlbG9jaXR5ID0gdGhpcy5sdjtcclxuICAgICAgICAgICAgbGV0IHN0YXRlID0gJyc7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuc3AueCA9PSAxKXtcclxuICAgICAgICAgICAgICAgIHN0YXRlID0gXCJoZXJvX3JpZ2h0XCI7XHJcbiAgICAgICAgICAgIH1lbHNlIGlmKHRoaXMuc3AueCA9PSAtMSl7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IFwiaGVyb19sZWZ0XCI7XHJcbiAgICAgICAgICAgIH1lbHNlIGlmKHRoaXMuc3AueSA9PSAxKXtcclxuICAgICAgICAgICAgICAgIHN0YXRlID0gXCJoZXJvX3VwXCI7XHJcbiAgICAgICAgICAgIH1lbHNlIGlmKHRoaXMuc3AueSA9PSAtMSl7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IFwiaGVyb19kb3duXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoc3RhdGUpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoc3RhdGUgJiYgSW5wdXRbY2MubWFjcm8uS0VZLmpdKXtcclxuICAgICAgICAgICAgICAgIGlmKCF0aGlzLl9raXRpbmcpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpdGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZXJvQW5pbS5wbGF5KHRoaXMuc3RhdGUrXCJfa2l0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUgPSAnJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYodGhpcy5teWNhbXJlYSAhPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHRoaXMubXljYW1yZWEueCA9IHRoaXMubm9kZS54O1xyXG4gICAgICAgICAgICB0aGlzLm15Y2FtcmVhLnkgPSB0aGlzLm5vZGUueTtcclxuICAgICAgICAgICAgaWYodGhpcy5mYWdQb25pbnQgIT0gbnVsbCAmJiB0aGlzLnJlY3QgIT0gbnVsbCl7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmZhZ1BvbmludCk7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLmZhZ1BvbmludC54ID0gdGhpcy5ub2RlLng7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLmZhZ1BvbmludC55ID0gdGhpcy5ub2RlLnk7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLnJlY3QueCA9IHRoaXMubm9kZS54O1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5yZWN0LnkgPSB0aGlzLm5vZGUueTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG59KTtcclxuIl19