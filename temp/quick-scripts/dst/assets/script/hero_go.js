
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/script/hero_go.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '06c69/yZBZMrKZIrO4yVjGA', 'hero_go');
// script/hero_go.js

"use strict";

var Input = {};
cc.Class({
  "extends": cc.Component,
  properties: {
    camrea: {
      type: cc.Node,
      "default": null
    },
    groundJsNode: {
      type: cc.Node,
      "default": null
    }
  },
  onLoad: function onLoad() {
    this.groundJs = this.groundJsNode.getComponent("ground2");

    var _this = this;

    _this.rect = null;
    _this.fagPoint = null;

    this.groundJs.Init = function () {
      _this.rect = _this.groundJs.MapRect;
      _this.fagPonint = _this.groundJs.flagPoint;
      _this.rect.width = 1500;
      _this.rect.height = 1000;
      _this.groundJs.mapCameraNode = _this.camrea;
      _this.node.parent = _this.groundJs.getLayerNodeFun("map"); //把当前节点放进地图js的hero图层
      // _this.groundJs.getLayerNodeFun("house").parent = null;
    }; //设置相机等属性，以及加入的map地图node


    if (this.camrea == null) {}

    if (this.groundJsNode == null) {} //人物的基本属性，速度，方向，重力


    this.walk = false;
    this.kit = false;
    this._speed = 200;
    this._speed1 = 200;
    this._speed2 = 300;
    this.state = '';
    this.sp = cc.v2(0, 0); //角色当前移动的方向

    this.heroAnim = this.node.getComponent(cc.Animation); // let p = cc.director.getPhysicsManager();    //得到物理组件
    // p.enabled = true;  //启用物理引擎
    // p.debugDrawFlags = true;  //显示出来碰撞边框，为了方便演示
    // cc.director.getCollisionManager().enabled = true; //检测碰撞
    // cc.director.getCollisionManager().enabledDebugDraw = true;//碰撞检测的边框显示
    // p.gravity = cc.v2(0,0);    //关闭重力
    //注册事件监听

    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.on_key_down, this); //向系统注册键盘按下事件

    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.on_key_up, this); //向系统注册键盘抬起事件
  },
  onCollisionEnter: function onCollisionEnter(other, self) {
    //碰撞开始
    if (other.tag == 1001) {
      other.node.gotoAndStop(other.node.currentFrame == 1 ? 5 : 1);
      this.groundJs.setYMovieClipFrame(this.groundJs.getTag("a1001"), other.node.currentFrame, false); //setYMovieClipFrame方法是播放制定动画的帧，第一个参数为动画标记，第二个是帧数，第三个是是播放还是跳到该帧就停止
    }

    if (other.tag == 2001) {
      this.groundJs.getLayerNodeFun("house").parent = this.groundJsNode;
      this.node.parent = this.groundJs.getLayerNodeFun("hero");
      this.groundJs.getLayerNodeFun("map").parent = null;
      this.groundJs.getLayerNodeFun("ground").parent = null;
    }
  },
  onCollisionStay: function onCollisionStay(other, self) {//碰撞持续
  },
  setState: function setState(state) {
    if (this.state == state) return;
    this.state = state;
    this.heroAnim.play(this.state);
  },
  hero_stop: function hero_stop() {
    this.heroAnim.stop(this.state);
  },
  on_key_down: function on_key_down(e) {
    //w:87  s:83   a:65  d:68  j:74  k:75  l:76  u:85  i:73   o:79  shift:16   l:76
    Input[e.keyCode] = 1;

    if (e.keyCode == 76) {
      this._speed = this._speed2;
    }
  },
  on_key_up: function on_key_up(e) {
    //w:87  s:83   a:65  d:68  j:74  k:75  l:76  u:85  i:73   o:79
    Input[e.keyCode] = 0;
    this.state = '';

    switch (e.keyCode) {
      case 87:
        //上
        this.hero_stop();
        break;

      case 65:
        //左
        this.hero_stop();
        break;

      case 68:
        //右
        this.hero_stop();
        break;

      case 83:
        //下
        this.hero_stop();
        break;

      case 76:
        this._speed = this._speed1;
        break;
    }
  },
  start: function start() {},
  update: function update(dt) {
    if (Input[cc.macro.KEY.d]) {
      this.sp.x = 1;
    } else if (Input[cc.macro.KEY.a]) {
      this.sp.x = -1;
    } else {
      this.sp.x = 0;
    }

    if (Input[cc.macro.KEY.w]) {
      this.sp.y = 1;
    } else if (Input[cc.macro.KEY.s]) {
      this.sp.y = -1;
    } else {
      this.sp.y = 0;
    }

    this.lv = this.node.getComponent(cc.RigidBody).linearVelocity;

    if (this.sp.x) {
      this.lv.y = 0;
      this.lv.x = this.sp.x * this._speed;
    } else if (this.sp.y) {
      this.lv.x = 0;
      this.lv.y = this.sp.y * this._speed;
    } else {
      this.lv.y = 0;
      this.lv.x = 0;
    }

    this.node.getComponent(cc.RigidBody).linearVelocity = this.lv;
    var state = '';

    if (this.sp.x == 1) {
      state = "hero_right";
    } else if (this.sp.x == -1) {
      state = "hero_left";
    } else if (this.sp.y == 1) {
      state = "hero_up";
    } else if (this.sp.y == -1) {
      state = "hero_down";
    }

    if (state) {
      this.setState(state);
    }

    if (this.camrea !== null) {
      this.camrea.x = this.node.x;
      this.camrea.y = this.node.y;

      if (this.fagPonint != null && this.rect != null) {// console.log(this.fagPonint);
        // this.fagPonint.x = this.node.x;
        // this.fagPonint.y = this.node.y;
        // this.rect.x = this.node.x;
        // this.rect.y = this.node.y;
      }
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0XFxoZXJvX2dvLmpzIl0sIm5hbWVzIjpbIklucHV0IiwiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJjYW1yZWEiLCJ0eXBlIiwiTm9kZSIsImdyb3VuZEpzTm9kZSIsIm9uTG9hZCIsImdyb3VuZEpzIiwiZ2V0Q29tcG9uZW50IiwiX3RoaXMiLCJyZWN0IiwiZmFnUG9pbnQiLCJJbml0IiwiTWFwUmVjdCIsImZhZ1BvbmludCIsImZsYWdQb2ludCIsIndpZHRoIiwiaGVpZ2h0IiwibWFwQ2FtZXJhTm9kZSIsIm5vZGUiLCJwYXJlbnQiLCJnZXRMYXllck5vZGVGdW4iLCJ3YWxrIiwia2l0IiwiX3NwZWVkIiwiX3NwZWVkMSIsIl9zcGVlZDIiLCJzdGF0ZSIsInNwIiwidjIiLCJoZXJvQW5pbSIsIkFuaW1hdGlvbiIsInN5c3RlbUV2ZW50Iiwib24iLCJTeXN0ZW1FdmVudCIsIkV2ZW50VHlwZSIsIktFWV9ET1dOIiwib25fa2V5X2Rvd24iLCJLRVlfVVAiLCJvbl9rZXlfdXAiLCJvbkNvbGxpc2lvbkVudGVyIiwib3RoZXIiLCJzZWxmIiwidGFnIiwiZ290b0FuZFN0b3AiLCJjdXJyZW50RnJhbWUiLCJzZXRZTW92aWVDbGlwRnJhbWUiLCJnZXRUYWciLCJvbkNvbGxpc2lvblN0YXkiLCJzZXRTdGF0ZSIsInBsYXkiLCJoZXJvX3N0b3AiLCJzdG9wIiwiZSIsImtleUNvZGUiLCJzdGFydCIsInVwZGF0ZSIsImR0IiwibWFjcm8iLCJLRVkiLCJkIiwieCIsImEiLCJ3IiwieSIsInMiLCJsdiIsIlJpZ2lkQm9keSIsImxpbmVhclZlbG9jaXR5Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQU1BLEtBQUssR0FBRyxFQUFkO0FBQ0FDLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ0wsYUFBU0QsRUFBRSxDQUFDRSxTQURQO0FBR0xDLEVBQUFBLFVBQVUsRUFBRTtBQUNSQyxJQUFBQSxNQUFN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QyxNQUFBQSxLQUFLLEdBQUcsWUFBUjtBQUNILEtBRkQsTUFFTSxJQUFHLEtBQUtDLEVBQUwsQ0FBUWlDLENBQVIsSUFBYSxDQUFDLENBQWpCLEVBQW1CO0FBQ3JCbEMsTUFBQUEsS0FBSyxHQUFHLFdBQVI7QUFDSCxLQUZLLE1BRUEsSUFBRyxLQUFLQyxFQUFMLENBQVFvQyxDQUFSLElBQWEsQ0FBaEIsRUFBa0I7QUFDcEJyQyxNQUFBQSxLQUFLLEdBQUcsU0FBUjtBQUNILEtBRkssTUFFQSxJQUFHLEtBQUtDLEVBQUwsQ0FBUW9DLENBQVIsSUFBYSxDQUFDLENBQWpCLEVBQW1CO0FBQ3JCckMsTUFBQUEsS0FBSyxHQUFHLFdBQVI7QUFDSDs7QUFDRCxRQUFHQSxLQUFILEVBQVM7QUFDTCxXQUFLc0IsUUFBTCxDQUFjdEIsS0FBZDtBQUNIOztBQUNELFFBQUcsS0FBS3pCLE1BQUwsS0FBZ0IsSUFBbkIsRUFBd0I7QUFDcEIsV0FBS0EsTUFBTCxDQUFZMkQsQ0FBWixHQUFnQixLQUFLMUMsSUFBTCxDQUFVMEMsQ0FBMUI7QUFDQSxXQUFLM0QsTUFBTCxDQUFZOEQsQ0FBWixHQUFnQixLQUFLN0MsSUFBTCxDQUFVNkMsQ0FBMUI7O0FBQ0EsVUFBRyxLQUFLbEQsU0FBTCxJQUFrQixJQUFsQixJQUEwQixLQUFLSixJQUFMLElBQWEsSUFBMUMsRUFBK0MsQ0FDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFFSjtBQXpLSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBJbnB1dCA9IHt9O1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGNhbXJlYTp7XHJcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZSxcclxuICAgICAgICAgICAgZGVmYXVsdDpudWxsLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ3JvdW5kSnNOb2RlOntcclxuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlLFxyXG4gICAgICAgICAgICBkZWZhdWx0Om51bGxcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZCAoKSB7XHJcbiAgICAgICAgdGhpcy5ncm91bmRKcyA9IHRoaXMuZ3JvdW5kSnNOb2RlLmdldENvbXBvbmVudChcImdyb3VuZDJcIik7XHJcbiAgICAgICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgICAgICBfdGhpcy5yZWN0ID0gbnVsbDtcclxuICAgICAgICBfdGhpcy5mYWdQb2ludCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5ncm91bmRKcy5Jbml0PWZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIF90aGlzLnJlY3QgPSBfdGhpcy5ncm91bmRKcy5NYXBSZWN0O1xyXG4gICAgICAgICAgICBfdGhpcy5mYWdQb25pbnQgPSBfdGhpcy5ncm91bmRKcy5mbGFnUG9pbnQ7XHJcbiAgICAgICAgICAgIF90aGlzLnJlY3Qud2lkdGggPSAxNTAwO1xyXG4gICAgICAgICAgICBfdGhpcy5yZWN0LmhlaWdodCA9IDEwMDA7XHJcbiAgICAgICAgICAgIF90aGlzLmdyb3VuZEpzLm1hcENhbWVyYU5vZGUgPSBfdGhpcy5jYW1yZWE7XHJcbiAgICAgICAgICAgIF90aGlzLm5vZGUucGFyZW50ID0gX3RoaXMuZ3JvdW5kSnMuZ2V0TGF5ZXJOb2RlRnVuKFwibWFwXCIpOy8v5oqK5b2T5YmN6IqC54K55pS+6L+b5Zyw5Zu+anPnmoRoZXJv5Zu+5bGCXHJcbiAgICAgICAgICAgIC8vIF90aGlzLmdyb3VuZEpzLmdldExheWVyTm9kZUZ1bihcImhvdXNlXCIpLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v6K6+572u55u45py6562J5bGe5oCn77yM5Lul5Y+K5Yqg5YWl55qEbWFw5Zyw5Zu+bm9kZVxyXG4gICAgICAgIGlmKHRoaXMuY2FtcmVhID09IG51bGwpe1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5ncm91bmRKc05vZGUgPT0gbnVsbCl7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICAvL+S6uueJqeeahOWfuuacrOWxnuaAp++8jOmAn+W6pu+8jOaWueWQke+8jOmHjeWKm1xyXG4gICAgICAgIHRoaXMud2FsayA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMua2l0ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fc3BlZWQgPSAyMDA7XHJcbiAgICAgICAgdGhpcy5fc3BlZWQxID0gMjAwO1xyXG4gICAgICAgIHRoaXMuX3NwZWVkMiA9IDMwMDtcclxuICAgICAgICB0aGlzLnN0YXRlID0gJyc7XHJcbiAgICAgICAgdGhpcy5zcCA9IGNjLnYyKDAsMCk7ICAvL+inkuiJsuW9k+WJjeenu+WKqOeahOaWueWQkVxyXG4gICAgICAgIHRoaXMuaGVyb0FuaW0gPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgLy8gbGV0IHAgPSBjYy5kaXJlY3Rvci5nZXRQaHlzaWNzTWFuYWdlcigpOyAgICAvL+W+l+WIsOeJqeeQhue7hOS7tlxyXG4gICAgICAgIC8vIHAuZW5hYmxlZCA9IHRydWU7ICAvL+WQr+eUqOeJqeeQhuW8leaTjlxyXG4gICAgICAgIC8vIHAuZGVidWdEcmF3RmxhZ3MgPSB0cnVlOyAgLy/mmL7npLrlh7rmnaXnorDmkp7ovrnmoYbvvIzkuLrkuobmlrnkvr/mvJTnpLpcclxuICAgICAgICAvLyBjYy5kaXJlY3Rvci5nZXRDb2xsaXNpb25NYW5hZ2VyKCkuZW5hYmxlZCA9IHRydWU7IC8v5qOA5rWL56Kw5pKeXHJcbiAgICAgICAgLy8gY2MuZGlyZWN0b3IuZ2V0Q29sbGlzaW9uTWFuYWdlcigpLmVuYWJsZWREZWJ1Z0RyYXcgPSB0cnVlOy8v56Kw5pKe5qOA5rWL55qE6L655qGG5pi+56S6XHJcbiAgICAgICAgLy8gcC5ncmF2aXR5ID0gY2MudjIoMCwwKTsgICAgLy/lhbPpl63ph43liptcclxuICAgICAgICAvL+azqOWGjOS6i+S7tuebkeWQrFxyXG4gICAgICAgIGNjLnN5c3RlbUV2ZW50Lm9uKGNjLlN5c3RlbUV2ZW50LkV2ZW50VHlwZS5LRVlfRE9XTix0aGlzLm9uX2tleV9kb3duLHRoaXMpOy8v5ZCR57O757uf5rOo5YaM6ZSu55uY5oyJ5LiL5LqL5Lu2XHJcbiAgICAgICAgY2Muc3lzdGVtRXZlbnQub24oY2MuU3lzdGVtRXZlbnQuRXZlbnRUeXBlLktFWV9VUCx0aGlzLm9uX2tleV91cCx0aGlzKTsvL+WQkeezu+e7n+azqOWGjOmUruebmOaKrOi1t+S6i+S7tlxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICBvbkNvbGxpc2lvbkVudGVyOmZ1bmN0aW9uKG90aGVyICwgc2VsZil7IC8v56Kw5pKe5byA5aeLXHJcbiAgICAgICAgaWYob3RoZXIudGFnID09IDEwMDEpe1xyXG4gICAgICAgICAgICBvdGhlci5ub2RlLmdvdG9BbmRTdG9wKG90aGVyLm5vZGUuY3VycmVudEZyYW1lPT0xPzU6MSk7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JvdW5kSnMuc2V0WU1vdmllQ2xpcEZyYW1lKHRoaXMuZ3JvdW5kSnMuZ2V0VGFnKFwiYTEwMDFcIiksb3RoZXIubm9kZS5jdXJyZW50RnJhbWUsZmFsc2UpOy8vc2V0WU1vdmllQ2xpcEZyYW1l5pa55rOV5piv5pKt5pS+5Yi25a6a5Yqo55S755qE5bin77yM56ys5LiA5Liq5Y+C5pWw5Li65Yqo55S75qCH6K6w77yM56ys5LqM5Liq5piv5bin5pWw77yM56ys5LiJ5Liq5piv5piv5pKt5pS+6L+Y5piv6Lez5Yiw6K+l5bin5bCx5YGc5q2iXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKG90aGVyLnRhZyA9PSAyMDAxKXtcclxuICAgICAgICAgICAgdGhpcy5ncm91bmRKcy5nZXRMYXllck5vZGVGdW4oXCJob3VzZVwiKS5wYXJlbnQgPSB0aGlzLmdyb3VuZEpzTm9kZTtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLnBhcmVudCA9IHRoaXMuZ3JvdW5kSnMuZ2V0TGF5ZXJOb2RlRnVuKFwiaGVyb1wiKTtcclxuICAgICAgICAgICAgdGhpcy5ncm91bmRKcy5nZXRMYXllck5vZGVGdW4oXCJtYXBcIikucGFyZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5ncm91bmRKcy5nZXRMYXllck5vZGVGdW4oXCJncm91bmRcIikucGFyZW50ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25Db2xsaXNpb25TdGF5OiBmdW5jdGlvbiAob3RoZXIsIHNlbGYpIHsgIC8v56Kw5pKe5oyB57utXHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG5cclxuICAgIHNldFN0YXRlKHN0YXRlKXtcclxuICAgICAgICBpZih0aGlzLnN0YXRlID09IHN0YXRlKXJldHVybjtcclxuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgICAgICB0aGlzLmhlcm9BbmltLnBsYXkodGhpcy5zdGF0ZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGhlcm9fc3RvcCgpe1xyXG4gICAgICAgIHRoaXMuaGVyb0FuaW0uc3RvcCh0aGlzLnN0YXRlKTtcclxuICAgIH0sXHJcblxyXG4gICAgb25fa2V5X2Rvd24oZSl7ICAgICAgICAgICAvL3c6ODcgIHM6ODMgICBhOjY1ICBkOjY4ICBqOjc0ICBrOjc1ICBsOjc2ICB1Ojg1ICBpOjczICAgbzo3OSAgc2hpZnQ6MTYgICBsOjc2XHJcbiAgICAgICAgSW5wdXRbZS5rZXlDb2RlXT0xO1xyXG4gICAgICAgIGlmKGUua2V5Q29kZSA9PSA3Nil7XHJcbiAgICAgICAgICAgIHRoaXMuX3NwZWVkID0gdGhpcy5fc3BlZWQyO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbl9rZXlfdXAoZSl7ICAgICAgICAvL3c6ODcgIHM6ODMgICBhOjY1ICBkOjY4ICBqOjc0ICBrOjc1ICBsOjc2ICB1Ojg1ICBpOjczICAgbzo3OVxyXG4gICAgICAgIElucHV0W2Uua2V5Q29kZV09MDtcclxuICAgICAgICB0aGlzLnN0YXRlID0gJyc7XHJcbiAgICAgICAgc3dpdGNoKGUua2V5Q29kZSl7XHJcbiAgICAgICAgICAgIGNhc2UgODc6ICAvL+S4ilxyXG4gICAgICAgICAgICAgICAgdGhpcy5oZXJvX3N0b3AoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDY1OiAgLy/lt6ZcclxuICAgICAgICAgICAgICAgIHRoaXMuaGVyb19zdG9wKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA2ODogICAvL+WPs1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oZXJvX3N0b3AoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDgzOiAgIC8v5LiLXHJcbiAgICAgICAgICAgICAgICB0aGlzLmhlcm9fc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNzY6XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zcGVlZCA9IHRoaXMuX3NwZWVkMTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc3RhcnQgKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlIChkdCkge1xyXG5cclxuICAgICAgICBpZihJbnB1dFtjYy5tYWNyby5LRVkuZF0pe1xyXG4gICAgICAgICAgICB0aGlzLnNwLnggPSAxO1xyXG4gICAgICAgIH1lbHNlIGlmKElucHV0W2NjLm1hY3JvLktFWS5hXSl7XHJcbiAgICAgICAgICAgIHRoaXMuc3AueCA9IC0xO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLnNwLnggPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihJbnB1dFtjYy5tYWNyby5LRVkud10pe1xyXG4gICAgICAgICAgICB0aGlzLnNwLnkgPSAxO1xyXG4gICAgICAgIH1lbHNlIGlmKElucHV0W2NjLm1hY3JvLktFWS5zXSl7XHJcbiAgICAgICAgICAgIHRoaXMuc3AueSA9IC0xO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLnNwLnkgPSAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5sdiA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuUmlnaWRCb2R5KS5saW5lYXJWZWxvY2l0eTtcclxuXHJcbiAgICAgICAgaWYodGhpcy5zcC54KXtcclxuICAgICAgICAgICAgdGhpcy5sdi55ID0gMDtcclxuICAgICAgICAgICAgdGhpcy5sdi54ID0gdGhpcy5zcC54ICogdGhpcy5fc3BlZWQ7XHJcbiAgICAgICAgfWVsc2UgaWYodGhpcy5zcC55KXtcclxuICAgICAgICAgICAgdGhpcy5sdi54ID0gMDtcclxuICAgICAgICAgICAgdGhpcy5sdi55ID0gdGhpcy5zcC55ICogdGhpcy5fc3BlZWQ7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMubHYueSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMubHYueCA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuUmlnaWRCb2R5KS5saW5lYXJWZWxvY2l0eSA9IHRoaXMubHY7XHJcbiAgICAgICAgbGV0IHN0YXRlID0gJyc7XHJcbiAgICAgICAgaWYodGhpcy5zcC54ID09IDEpe1xyXG4gICAgICAgICAgICBzdGF0ZSA9IFwiaGVyb19yaWdodFwiO1xyXG4gICAgICAgIH1lbHNlIGlmKHRoaXMuc3AueCA9PSAtMSl7XHJcbiAgICAgICAgICAgIHN0YXRlID0gXCJoZXJvX2xlZnRcIjtcclxuICAgICAgICB9ZWxzZSBpZih0aGlzLnNwLnkgPT0gMSl7XHJcbiAgICAgICAgICAgIHN0YXRlID0gXCJoZXJvX3VwXCI7XHJcbiAgICAgICAgfWVsc2UgaWYodGhpcy5zcC55ID09IC0xKXtcclxuICAgICAgICAgICAgc3RhdGUgPSBcImhlcm9fZG93blwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihzdGF0ZSl7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLmNhbXJlYSAhPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHRoaXMuY2FtcmVhLnggPSB0aGlzLm5vZGUueDtcclxuICAgICAgICAgICAgdGhpcy5jYW1yZWEueSA9IHRoaXMubm9kZS55O1xyXG4gICAgICAgICAgICBpZih0aGlzLmZhZ1BvbmludCAhPSBudWxsICYmIHRoaXMucmVjdCAhPSBudWxsKXtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuZmFnUG9uaW50KTtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuZmFnUG9uaW50LnggPSB0aGlzLm5vZGUueDtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuZmFnUG9uaW50LnkgPSB0aGlzLm5vZGUueTtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMucmVjdC54ID0gdGhpcy5ub2RlLng7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLnJlY3QueSA9IHRoaXMubm9kZS55O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcbn0pO1xyXG4iXX0=