{"version":3,"sources":["assets\\script\\hero_go.js"],"names":["Input","cc","Class","Component","properties","mycamrea","type","Node","groundJsNode","map","heroPos","top","onLoad","_this","rect","fagPoint","playing","walk","kit","_speed","_speed1","_speed2","_kiting","node","setPosition","v2","state","sp","heroAnim","getComponent","Animation","director","getPhysicsManager","gravity","y","systemEvent","on","SystemEvent","EventType","KEY_DOWN","on_key_down","KEY_UP","on_key_up","herobody","RigidBody","input_control","on_key_down_1","on_key_up_1","onCollisionEnter","other","self","tag","gotoAndStop","currentFrame","groundJs","setYMovieClipFrame","getTag","game","notice","getPosition","loadScene","getLayerNodeFun","p602","p603","p604","onCollisionStay","kit_end","play","setState","hero_stop","stop","on_player_jump","v","linearVelocity","on_player_walk","dir","x","scaleX","e","keyCode","openAndClosePackage","noticeExit","start","mapCameraNode","topPosheight","update","dt","macro","KEY","d","a","w","s","lv","pp","j","fagPonint"],"mappings":"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","sourceRoot":"/","sourcesContent":["const Input = {};\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        mycamrea:{\r\n            type:cc.Node,\r\n            default:null,\r\n        },\r\n        groundJsNode:{\r\n            type:cc.Node,\r\n            default:null\r\n        },\r\n        map:null,\r\n        heroPos:null,\r\n        top:{\r\n            type:cc.Node,\r\n            default:null\r\n        }\r\n    },\r\n\r\n    onLoad () {\r\n        let _this = this;\r\n        _this.rect = null;\r\n        _this.fagPoint = null;\r\n        //设置相机等属性，以及加入的map地图node\r\n        // if(this.camrea == null){\r\n        //\r\n        // }\r\n        // if(this.groundJsNode == null){\r\n        //\r\n        // }\r\n        //人物的基本属性，速度，方向，重力\r\n        this.playing = true;//是否正在游戏中还是在查看背包，查看别的信息时角色不能移动\r\n        this.walk = false;\r\n        this.kit = false;\r\n        this._speed = 200;\r\n        this._speed1 = 200;\r\n        this._speed2 = 300;\r\n        this._kiting = false;\r\n        if(this.heroPos != null){\r\n            this.node.setPosition(this.heroPos);\r\n        }else{\r\n            this.node.setPosition(cc.v2(0,0));//初始位置\r\n        }\r\n        this.state = '';\r\n        this.sp = cc.v2(0,0);  //角色当前移动的方向\r\n        this.heroAnim = this.node.getComponent(cc.Animation);\r\n\r\n        //注册事件监听\r\n        if(cc.director.getPhysicsManager().gravity.y == 0){//未开启重力的键盘监听，没有自由落体\r\n            cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.on_key_down,this);//向系统注册键盘按下事件\r\n            cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.on_key_up,this);//向系统注册键盘抬起事件\r\n        }else{//开启重力的键盘监听,有自由落体\r\n            this.herobody = this.node.getComponent(cc.RigidBody);//把刚体保存下来\r\n            this.input_control = 0;\r\n            cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.on_key_down_1,this);//向系统注册键盘按下事件\r\n            cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.on_key_up_1,this);//向系统注册键盘抬起事件\r\n        }\r\n\r\n    },\r\n\r\n    onCollisionEnter:function(other , self){ //碰撞开始\r\n        switch (other.tag) {\r\n            case 1001:\r\n                other.node.gotoAndStop(other.node.currentFrame==1?5:1);\r\n                this.groundJs.setYMovieClipFrame(this.groundJs.getTag(\"a1001\"),other.node.currentFrame,false);//setYMovieClipFrame方法是播放制定动画的帧，第一个参数为动画标记，第二个是帧数，第三个是是播放还是跳到该帧就停止\r\n                break;\r\n            case 300:\r\n                this.playing = false;\r\n                game.notice(\"房间里什么都没有!!去别的房子看看吧\",this.node.getPosition());\r\n                break;\r\n            case 501:\r\n                // game.switchMap(\"map\",\"map3\");//切换地图\r\n                cc.director.loadScene(\"game3\");\r\n                // this.groundJs.removeAll();\r\n                break;\r\n            case 601:\r\n                // game.switchMap(\"map3\",\"map\");//切换地图\r\n                cc.director.loadScene(\"game1\");\r\n                // this.groundJs.removeAll();\r\n                break;\r\n            case 602:\r\n                this.node.setPosition(this.groundJs.getLayerNodeFun(\"map\").p602)\r\n                break;\r\n            case 603:\r\n                this.node.setPosition(this.groundJs.getLayerNodeFun(\"map\").p603)\r\n                break;\r\n            case 604:\r\n                this.node.setPosition(this.groundJs.getLayerNodeFun(\"map\").p604)\r\n                break;\r\n        }\r\n    },\r\n    onCollisionStay: function (other, self) {  //碰撞持续\r\n        \r\n    },\r\n\r\n    kit_end(){\r\n        this._kiting = false;\r\n        this.heroAnim.play(this.state);\r\n    },\r\n\r\n    setState(state){\r\n        if(this.state == state)return;\r\n            this.state = state;\r\n        if(this._kiting)return;\r\n        this.heroAnim.play(this.state);\r\n    },\r\n\r\n    hero_stop(){\r\n        this.heroAnim.stop(this.state);\r\n    },\r\n\r\n    on_player_jump(){//有自由落体时的跳跃\r\n        var v = this.node.getComponent(cc.RigidBody).linearVelocity;\r\n        v.y = 800;\r\n        this.node.getComponent(cc.RigidBody).linearVelocity = v;\r\n    },\r\n\r\n    on_player_walk(dir){//有自由落体时的行走\r\n        var v = this.node.getComponent(cc.RigidBody).linearVelocity;\r\n        v.x = (300 * dir);\r\n        this.node.scaleX = dir;\r\n        this.node.getComponent(cc.RigidBody).linearVelocity = v;\r\n    },\r\n\r\n    on_key_down_1(e){\r\n        switch(e.keyCode){\r\n            case 87:\r\n                this.on_player_jump();\r\n                break;\r\n            case 65:\r\n                this.input_control = -1;\r\n                break;\r\n            case 68:\r\n                this.input_control = 1;\r\n                break;\r\n            case 66:\r\n                this.playing = !this.playing;\r\n                game.openAndClosePackage(this.node.getPosition());\r\n                break;\r\n        }\r\n    },\r\n    on_key_up_1(e){\r\n        switch(e.keyCode){\r\n            case 65:\r\n                this.input_control = 0;\r\n                break;\r\n            case 68:\r\n                this.input_control = 0;\r\n                break;\r\n        }\r\n    },\r\n\r\n    on_key_down(e){           //w:87  s:83   a:65  d:68  j:74  k:75  l:76  u:85  i:73   o:79  shift:16   l:76   空格：32  q:81\r\n        Input[e.keyCode]=1;\r\n        switch (e.keyCode) {\r\n            case 76:\r\n                this._speed = this._speed2;\r\n                break;\r\n            case 81:\r\n                game.noticeExit();\r\n                this.playing = true;\r\n                break;\r\n            case 66:   //打开或关闭背包\r\n                this.playing = !this.playing;\r\n                game.openAndClosePackage(this.node.getPosition());\r\n                break;\r\n        }\r\n    },\r\n    on_key_up(e){        //w:87  s:83   a:65  d:68  j:74  k:75  l:76  u:85  i:73   o:79\r\n        Input[e.keyCode]=0;\r\n        this.state = '';\r\n        switch(e.keyCode){\r\n            case 87:  //上\r\n                this.hero_stop();\r\n                break;\r\n            case 65:  //左\r\n                this.hero_stop();\r\n                break;\r\n            case 68:   //右\r\n                this.hero_stop();\r\n                break;\r\n            case 83:   //下\r\n                this.hero_stop();\r\n                break;\r\n            case 76:\r\n                this._speed = this._speed1;\r\n                break;\r\n        }\r\n    },\r\n\r\n    start () {\r\n        this.groundJs = this.groundJsNode.getComponent(this.map);\r\n        this.groundJs.mapCameraNode = this.mycamrea;\r\n\r\n        this.topPosheight = this.top.getPosition().y - this.node.getPosition().y;//界面顶部的top信息，等级，经验，头像等\r\n    },\r\n\r\n    update (dt) {\r\n        if(this.playing){\r\n            if(cc.director.getPhysicsManager().gravity.y == 0){\r\n                if(Input[cc.macro.KEY.d]){\r\n                    this.sp.x = 1;\r\n                }else if(Input[cc.macro.KEY.a]){\r\n                    this.sp.x = -1;\r\n                }else{\r\n                    this.sp.x = 0;\r\n                }\r\n                if(Input[cc.macro.KEY.w]){\r\n                    this.sp.y = 1;\r\n                }else if(Input[cc.macro.KEY.s]){\r\n                    this.sp.y = -1;\r\n                }else{\r\n                    this.sp.y = 0;\r\n                }\r\n\r\n                this.lv = this.node.getComponent(cc.RigidBody).linearVelocity;\r\n\r\n                if(this.sp.x){\r\n                    this.lv.y = 0;\r\n                    this.lv.x = this.sp.x * this._speed;\r\n                }else if(this.sp.y){\r\n                    this.lv.x = 0;\r\n                    this.lv.y = this.sp.y * this._speed;\r\n                }else{\r\n                    this.lv.y = 0;\r\n                    this.lv.x = 0;\r\n                }\r\n                if(!this._kiting){\r\n                    this.node.getComponent(cc.RigidBody).linearVelocity = this.lv;\r\n                }\r\n                let pp = new cc.v2(this.node.x,this.node.y +this.topPosheight);\r\n                this.top.setPosition(pp);\r\n                let state = '';\r\n                if(this.sp.x == 1){\r\n                    state = \"hero_right\";\r\n                }else if(this.sp.x == -1){\r\n                    state = \"hero_left\";\r\n                }else if(this.sp.y == 1){\r\n                    state = \"hero_up\";\r\n                }else if(this.sp.y == -1){\r\n                    state = \"hero_down\";\r\n                }\r\n                if(state){\r\n                    this.setState(state);\r\n                }\r\n                if(state && Input[cc.macro.KEY.j]){\r\n                    if(!this._kiting){\r\n                        this._kiting = true;\r\n                        this.heroAnim.play(this.state+\"_kit\");\r\n                        this.state = '';\r\n                    }\r\n                }\r\n            }else{\r\n                if(this.input_control !== 0){\r\n                    this.on_player_walk(this.input_control);\r\n                }\r\n            }\r\n        }\r\n\r\n        if(this.mycamrea !== null){\r\n            this.mycamrea.x = this.node.x;\r\n            // if(cc.director.getPhysicsManager().gravity.y == 0){\r\n                this.mycamrea.y = this.node.y;\r\n            // }\r\n            if(this.fagPonint != null && this.rect != null){\r\n                // console.log(this.fagPonint);\r\n                // this.fagPonint.x = this.node.x;\r\n                // this.fagPonint.y = this.node.y;\r\n                // this.rect.x = this.node.x;\r\n                // this.rect.y = this.node.y;\r\n            }\r\n        }\r\n\r\n    },\r\n});\r\n"]}