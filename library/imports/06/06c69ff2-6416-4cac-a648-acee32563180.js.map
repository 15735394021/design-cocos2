{"version":3,"sources":["assets\\script\\hero_go.js"],"names":["Input","cc","Class","Component","properties","mycamrea","type","Node","groundJsNode","onLoad","window","hero_go","groundJs","getComponent","_this","rect","fagPoint","playing","walk","kit","_speed","_speed1","_speed2","_kiting","state","sp","v2","heroAnim","node","Animation","systemEvent","on","SystemEvent","EventType","KEY_DOWN","on_key_down","KEY_UP","on_key_up","onCollisionEnter","other","self","tag","gotoAndStop","currentFrame","setYMovieClipFrame","getTag","getLayerNodeFun","parent","game","notice","x","y","console","log","onCollisionStay","kit_end","play","d","setState","hero_stop","stop","e","keyCode","noticeExit","start","update","dt","macro","KEY","a","w","s","lv","RigidBody","linearVelocity","j","fagPonint"],"mappings":"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","sourceRoot":"/","sourcesContent":["const Input = {};\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        mycamrea:{\r\n            type:cc.Node,\r\n            default:null,\r\n        },\r\n        groundJsNode:{\r\n            type:cc.Node,\r\n            default:null\r\n        }\r\n    },\r\n\r\n    onLoad () {\r\n        window.hero_go = this;\r\n        this.groundJs = this.groundJsNode.getComponent(\"ground2\");\r\n        let _this = this;\r\n        _this.rect = null;\r\n        _this.fagPoint = null;\r\n        //设置相机等属性，以及加入的map地图node\r\n        // if(this.camrea == null){\r\n        //\r\n        // }\r\n        // if(this.groundJsNode == null){\r\n        //\r\n        // }\r\n        //人物的基本属性，速度，方向，重力\r\n        this.playing = true;//是否正在游戏中还是在查看背包，查看别的信息时角色不能移动\r\n        this.walk = false;\r\n        this.kit = false;\r\n        this._speed = 200;\r\n        this._speed1 = 200;\r\n        this._speed2 = 300;\r\n        this._kiting = false;\r\n        this.state = '';\r\n        this.sp = cc.v2(0,0);  //角色当前移动的方向\r\n        this.heroAnim = this.node.getComponent(cc.Animation);\r\n        // let p = cc.director.getPhysicsManager();    //得到物理组件\r\n        // p.enabled = true;  //启用物理引擎\r\n        // p.debugDrawFlags = true;  //显示出来碰撞边框，为了方便演示\r\n        // cc.director.getCollisionManager().enabled = true; //检测碰撞\r\n        // cc.director.getCollisionManager().enabledDebugDraw = true;//碰撞检测的边框显示\r\n        // p.gravity = cc.v2(0,0);    //关闭重力\r\n\r\n        //注册事件监听\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.on_key_down,this);//向系统注册键盘按下事件\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.on_key_up,this);//向系统注册键盘抬起事件\r\n        \r\n    },\r\n\r\n    onCollisionEnter:function(other , self){ //碰撞开始\r\n        if(other.tag == 1001){\r\n            other.node.gotoAndStop(other.node.currentFrame==1?5:1);\r\n            this.groundJs.setYMovieClipFrame(this.groundJs.getTag(\"a1001\"),other.node.currentFrame,false);//setYMovieClipFrame方法是播放制定动画的帧，第一个参数为动画标记，第二个是帧数，第三个是是播放还是跳到该帧就停止\r\n        }\r\n        if(other.tag == 2001){\r\n            this.groundJs.getLayerNodeFun(\"house\").parent = this.groundJsNode;\r\n            this.node.parent = this.groundJs.getLayerNodeFun(\"hero\");\r\n            this.groundJs.getLayerNodeFun(\"map\").parent = null;\r\n            this.groundJs.getLayerNodeFun(\"ground\").parent = null;\r\n        }\r\n        if(other.tag == 300){\r\n            this.playing = false;\r\n            game.notice(\"房间里什么都没有!!去别的房子看看吧\",this.node.x,this.node.y);\r\n        }\r\n        if(other.tag == 501){\r\n            console.log(\"跨越第一个地图\")\r\n        }\r\n    },\r\n    onCollisionStay: function (other, self) {  //碰撞持续\r\n        \r\n    },\r\n\r\n    kit_end(){\r\n        this._kiting = false;\r\n        this.heroAnim.play(this.state);d\r\n    },\r\n\r\n    setState(state){\r\n        if(this.state == state)return;\r\n            this.state = state;\r\n        if(this._kiting)return;\r\n        this.heroAnim.play(this.state);\r\n    },\r\n\r\n    hero_stop(){\r\n        this.heroAnim.stop(this.state);\r\n    },\r\n    on_key_down(e){           //w:87  s:83   a:65  d:68  j:74  k:75  l:76  u:85  i:73   o:79  shift:16   l:76   空格：32  q:81\r\n        Input[e.keyCode]=1;\r\n        if(e.keyCode == 76){\r\n            this._speed = this._speed2;\r\n        }\r\n        if(e.keyCode == 81){\r\n            game.noticeExit();\r\n            this.playing = true;\r\n        }\r\n    },\r\n    on_key_up(e){        //w:87  s:83   a:65  d:68  j:74  k:75  l:76  u:85  i:73   o:79\r\n        Input[e.keyCode]=0;\r\n        this.state = '';\r\n        switch(e.keyCode){\r\n            case 87:  //上\r\n                this.hero_stop();\r\n                break;\r\n            case 65:  //左\r\n                this.hero_stop();\r\n                break;\r\n            case 68:   //右\r\n                this.hero_stop();\r\n                break;\r\n            case 83:   //下\r\n                this.hero_stop();\r\n                break;\r\n            case 76:\r\n                this._speed = this._speed1;\r\n                break;\r\n        }\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    update (dt) {\r\n        if(this.playing){\r\n            if(Input[cc.macro.KEY.d]){\r\n                this.sp.x = 1;\r\n            }else if(Input[cc.macro.KEY.a]){\r\n                this.sp.x = -1;\r\n            }else{\r\n                this.sp.x = 0;\r\n            }\r\n            if(Input[cc.macro.KEY.w]){\r\n                this.sp.y = 1;\r\n            }else if(Input[cc.macro.KEY.s]){\r\n                this.sp.y = -1;\r\n            }else{\r\n                this.sp.y = 0;\r\n            }\r\n\r\n            this.lv = this.node.getComponent(cc.RigidBody).linearVelocity;\r\n\r\n            if(this.sp.x){\r\n                this.lv.y = 0;\r\n                this.lv.x = this.sp.x * this._speed;\r\n            }else if(this.sp.y){\r\n                this.lv.x = 0;\r\n                this.lv.y = this.sp.y * this._speed;\r\n            }else{\r\n                this.lv.y = 0;\r\n                this.lv.x = 0;\r\n            }\r\n            this.node.getComponent(cc.RigidBody).linearVelocity = this.lv;\r\n            let state = '';\r\n            if(this.sp.x == 1){\r\n                state = \"hero_right\";\r\n            }else if(this.sp.x == -1){\r\n                state = \"hero_left\";\r\n            }else if(this.sp.y == 1){\r\n                state = \"hero_up\";\r\n            }else if(this.sp.y == -1){\r\n                state = \"hero_down\";\r\n            }\r\n            if(state){\r\n                this.setState(state);\r\n            }\r\n            if(state && Input[cc.macro.KEY.j]){\r\n                if(!this._kiting){\r\n                    this._kiting = true;\r\n                    this.heroAnim.play(this.state+\"_kit\");\r\n                    this.state = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        if(this.mycamrea !== null){\r\n            this.mycamrea.x = this.node.x;\r\n            this.mycamrea.y = this.node.y;\r\n            if(this.fagPonint != null && this.rect != null){\r\n                // console.log(this.fagPonint);\r\n                // this.fagPonint.x = this.node.x;\r\n                // this.fagPonint.y = this.node.y;\r\n                // this.rect.x = this.node.x;\r\n                // this.rect.y = this.node.y;\r\n            }\r\n        }\r\n\r\n    },\r\n});\r\n"]}