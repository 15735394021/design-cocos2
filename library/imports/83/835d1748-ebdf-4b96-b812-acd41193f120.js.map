{"version":3,"sources":["assets\\script\\heroModel.js"],"names":["cc","Class","Component","properties","heroGrade","type","Node","heroExperience","heroLife","heroGold","onLoad","baseUrl","queryHeroDetail","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","data","addExperience","getComponent","Label","string","userGold","bind","open","send","addGrade","grade","parseInt","num","totol","getChildByName","width","ProgressBar","totalLength","addLife","life","widht","addGold","gold","useGold","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        heroGrade:{//等级\r\n            type:cc.Node,\r\n            default:null\r\n        },\r\n        heroExperience:{//经验值\r\n            type:cc.Node,\r\n            default:null\r\n        },\r\n        heroLife:{//生命值\r\n            type:cc.Node,\r\n            default:null\r\n        },\r\n        heroGold:{//金币\r\n            type:cc.Node,\r\n            default:null\r\n        },\r\n    },\r\n\r\n    onLoad () {\r\n        this.baseUrl = \"http://47.104.80.127:8080/\";\r\n        this.queryHeroDetail();\r\n    },\r\n\r\n    queryHeroDetail(){\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                var response = JSON.parse(xhr.responseText);\r\n                if(response.status == 0){\r\n                    let data = response.data[0];\r\n                    this.addExperience();\r\n                    this.heroGold.getComponent(cc.Label).string =data.userGold;\r\n                }\r\n            }\r\n        }.bind(this);\r\n        xhr.open(\"GET\", this.baseUrl+\"archives/queryArchives?userId=1\", true);\r\n        xhr.send();\r\n    },\r\n\r\n    addGrade(){//增加等级\r\n        let grade = parseInt(this.heroGrade.getComponent(cc.Label).string);\r\n        this.heroGrade.getComponent(cc.Label).string = grade+1;\r\n    },\r\n\r\n    addExperience(num){//增加经验值\r\n        let totol = this.heroExperience.getChildByName(\"bar\").width;\r\n        totol += num;\r\n        if(totol < this.heroExperience.getComponent(cc.ProgressBar).totalLength){\r\n            this.heroExperience.getChildByName(\"bar\").width = totol;\r\n        }else{\r\n            this.addGrade();\r\n            this.heroExperience.getChildByName(\"bar\").width = totol/300;\r\n        }\r\n    },\r\n\r\n    addLife(num){\r\n        let life = this.heroLife.getChildByName(\"bar\").width;\r\n        life += num;\r\n        if(life < this.heroLife.getComponent(cc.ProgressBar).totalLength){\r\n            this.heroLife.getChildByName(\"bat\").widht = life;\r\n        }else{\r\n            this.heroLife.getChildByName(\"bat\").widht = 300;\r\n        }\r\n    },\r\n\r\n    addGold(num){//增加金币\r\n        let gold = parseInt(this.heroGold.getComponent(cc.Label).string);\r\n        this.heroGold.getComponent(cc.Label).string = gold+num;\r\n    },\r\n\r\n    useGold(num){//使用金币，减少\r\n        let gold = parseInt(this.heroGold.getComponent(cc.Label).string);\r\n        this.heroGold.getComponent(cc.Label).string = gold-num;\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}