{"version":3,"sources":["assets\\script\\archivesList.js"],"names":["cc","Class","Component","properties","archivesPre","type","Prefab","onLoad","baseUrl","queryArchives","userId","sys","localStorage","getItem","node","height","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","data","createArchivesList","bind","open","send","i","length","archivesNode","instantiate","archivesJs","getComponent","createTime","ts","archivesName","grade","userGrade","experience","userExperience","gold","userGold","describe","archivesDescribe","checkPoint","parent","setPosition","v2","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        archivesPre:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        }\r\n    },\r\n\r\n    onLoad () {\r\n        this.baseUrl = \"http://47.104.80.127:8080/\";\r\n        this.queryArchives();\r\n        this.userId = cc.sys.localStorage.getItem(\"userId\");\r\n        if(this.userId == null){\r\n            this.userId = 1;\r\n        }\r\n        this.node.height = 0; //初始化时设置档案纪录的content高度为0，之后每创建一行高度再增加\r\n    },\r\n\r\n    queryArchives(){\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                var response = JSON.parse(xhr.responseText);\r\n                if(response.status == 0){\r\n                    let data = response.data;\r\n                    this.createArchivesList(data);\r\n                }\r\n            }\r\n        }.bind(this);\r\n        // xhr.open(\"GET\", this.baseUrl+\"archives/queryArchives?userId=\"+this.userId, true);\r\n        xhr.open(\"GET\", this.baseUrl+\"archives/queryArchives?userId=1\", true);\r\n        xhr.send();\r\n    },\r\n\r\n    createArchivesList(data){\r\n        for (let i = 0; i < data.length; i++) {\r\n            this.node.height += 80;\r\n            let archivesNode = cc.instantiate(this.archivesPre);\r\n            let archivesJs = archivesNode.getComponent(\"archive\");\r\n            archivesJs.createTime = data[i].ts;\r\n            archivesJs.archivesName = data[i].archivesName;\r\n            archivesJs.grade = data[i].userGrade;\r\n            archivesJs.experience = data[i].userExperience;\r\n            archivesJs.gold = data[i].userGold;\r\n            archivesJs.describe = data[i].archivesDescribe;\r\n            archivesJs.checkPoint = data[i].checkPoint;\r\n            archivesNode.parent = this.node;\r\n            archivesNode.setPosition(cc.v2(0,-40 - 80 * i));\r\n        }\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}