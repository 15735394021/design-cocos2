{"version":3,"sources":["assets\\script\\game.js"],"names":["requestUrl","cc","Class","Component","properties","noticeLabel","type","Label","myPackage","Node","openDoorAudio","AudioClip","openPackageAudio","onLoad","p","director","getPhysicsManager","enabled","gravity","v2","getCollisionManager","window","game","active","initialization","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","console","log","open","send","queryHeroDetail","openAndClosePackage","pos","audioEngine","play","setPosition","notice","message","node","getChildByName","opacity","overflow","Overflow","RESIZE_HEIGHT","_contentSize","width","string","noticeExit","switchMap","oldMap","newMap","start","baseUrl","update","dt"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\nconst requestUrl = \"http://47.104.80.127:8080/\"\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        noticeLabel:{\r\n            type:cc.Label,\r\n            default:null\r\n        },\r\n        myPackage:{\r\n            type:cc.Node,\r\n            default:null\r\n        },\r\n        openDoorAudio:{\r\n            type:cc.AudioClip,\r\n            default:null\r\n        },\r\n        openPackageAudio:{\r\n            type:cc.AudioClip,\r\n            default:null\r\n        },\r\n\r\n    },\r\n\r\n    onLoad () {\r\n        let p = cc.director.getPhysicsManager();\r\n        p.enabled = true;\r\n        p.gravity = cc.v2(0,0); \r\n        // p.debugDrawFlags = true;  //显示出来碰撞边框，为了方便演示\r\n        cc.director.getCollisionManager().enabled = true; //检测碰撞\r\n        // cc.director.getCollisionManager().enabledDebugDraw = true;//碰撞检测的边框显示\r\n\r\n        window.game = this;\r\n        // this.initialization();//游戏开始的数据初始化   网络请求\r\n        // this.queryHeroDetail();  //已经在heroDetail.js里调用\r\n\r\n        //通知提示的label初始化时active为false;\r\n        this.noticeLabel.active = false;\r\n        this.myPackage.active = false;//背包初始化不显示\r\n\r\n    },\r\n\r\n\r\n    initialization(){   //进入游戏的个人数据初始化,查背包\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                var response = JSON.parse(xhr.responseText);\r\n                console.log(response);\r\n            }\r\n        };\r\n        xhr.open(\"GET\", requestUrl+\"archives/beginGame?archivesId=1\", true);\r\n        xhr.send();\r\n    },\r\n\r\n    queryHeroDetail(){\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                var response = JSON.parse(xhr.responseText);\r\n                // console.log(response);\r\n            }\r\n        };\r\n        xhr.open(\"GET\", requestUrl+\"archives/queryArchives?userId=1\", true);\r\n        xhr.send();\r\n    },\r\n\r\n    openAndClosePackage(pos){\r\n        this.myPackage.active = !this.myPackage.active;\r\n        cc.audioEngine.play(this.openPackageAudio,false,0.3);\r\n        if(this.myPackage.active){\r\n            this.myPackage.setPosition(pos);\r\n        }\r\n    },\r\n\r\n    notice(message,pos){  //进入房间的提示“房间没有东西，按q退出”\r\n      this.node.getChildByName(\"map\").opacity = 30;\r\n      this.node.getChildByName(\"hero\").opacity = 30;\r\n      cc.audioEngine.play(this.openDoorAudio,false,0.3);\r\n      // this.node.addComponent(cc.Label);\r\n      //   let noticeLabel = this.node.getComponent(cc.Label);   //notice打算动态生成的，而不是在this.noticeLabel节点更改\r\n      //       noticeLabel.node.setPosition(pos);\r\n      //   console.log(this.noticeLabel)\r\n      //   console.log(noticeLabel)\r\n        this.noticeLabel.node.setPosition(pos);\r\n        this.noticeLabel.node.active = true;\r\n      this.noticeLabel.overflow = cc.Label.Overflow.RESIZE_HEIGHT;//自适应高度。文字越多，会扩展高度\r\n      this.noticeLabel.node._contentSize.width = 800;\r\n      this.noticeLabel.string = message+\"......  按'q'键退出\";\r\n    },\r\n\r\n    noticeExit(){   //按q键退出的处理\r\n      this.node.getChildByName(\"map\").opacity = 255;\r\n      this.node.getChildByName(\"hero\").opacity = 255;\r\n      // this.node.getComponent(cc.Label).destroy();\r\n        cc.audioEngine.play(this.openDoorAudio,false,0.3);\r\n        this.noticeLabel.node.active = false;\r\n    },\r\n\r\n    switchMap(oldMap,newMap){\r\n        this.node.getChildByName(oldMap).active = false;\r\n        this.node.getChildByName(newMap).active = true;\r\n    },\r\n\r\n    start () {\r\n        this.baseUrl = \"http://47.104.80.127:8080/\";\r\n    },\r\n\r\n    update (dt) {\r\n\r\n    },\r\n});\r\n"]}