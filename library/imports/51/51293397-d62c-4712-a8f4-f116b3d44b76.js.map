{"version":3,"sources":["assets\\script\\game.js"],"names":["requestUrl","cc","Class","Component","properties","noticeLabel","type","Label","myPackage","Node","openAndPackageAudio","AudioClip","openDoor","hcs_pre","Prefab","onLoad","p","director","getPhysicsManager","enabled","gravity","v2","getCollisionManager","window","game","active","initialization","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","console","log","open","send","queryHeroDetail","openAndClosePackage","pos","audioEngine","play","setPosition","notice","message","node","getChildByName","opacity","overflow","Overflow","RESIZE_HEIGHT","_contentSize","width","string","noticeExit","openKnapsack","start","sys","localStorage","getItem","loadScene","loadNewScene","scene","preloadScene","timer1","setTimeout","herocsNode","instantiate","parent"],"mappings":";;;;;;AACA,IAAMA,UAAU,GAAG,4BAAnB;AAEAC,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AACRC,IAAAA,WAAW,EAAC;AACRC,MAAAA,IAAI,EAACL,EAAE,CAACM,KADA;AAER,iBAAQ;AAFA,KADJ;AAKRC,IAAAA,SAAS,EAAE;AACPF,MAAAA,IAAI,EAAEL,EAAE,CAACQ,IADF;AAEP,iBAAS;AAFF,KALH;AASRC,IAAAA,mBAAmB,EAAC;AAChBJ,MAAAA,IAAI,EAACL,EAAE,CAACU,SADQ;AAEhB,iBAAQ;AAFQ,KATZ;AAaRC,IAAAA,QAAQ,EAAC;AACLN,MAAAA,IAAI,EAACL,EAAE,CAACU,SADH;AAEL,iBAAQ;AAFH,KAbD;AAiBRE,IAAAA,OAAO,EAAC;AACJP,MAAAA,IAAI,EAACL,EAAE,CAACa,MADJ;AAEJ,iBAAQ;AAFJ;AAjBA,GAHP;AA2BLC,EAAAA,MA3BK,oBA2BK;AACN,QAAIC,CAAC,GAAGf,EAAE,CAACgB,QAAH,CAAYC,iBAAZ,EAAR;AACAF,IAAAA,CAAC,CAACG,OAAF,GAAY,IAAZ;AACAH,IAAAA,CAAC,CAACI,OAAF,GAAYnB,EAAE,CAACoB,EAAH,CAAM,CAAN,EAAQ,CAAR,CAAZ,CAHM,CAIN;;AACApB,IAAAA,EAAE,CAACgB,QAAH,CAAYK,mBAAZ,GAAkCH,OAAlC,GAA4C,IAA5C,CALM,CAK4C;AAClD;;AAEAI,IAAAA,MAAM,CAACC,IAAP,GAAc,IAAd,CARM,CASN;AACA;AAEA;;AACA,SAAKnB,WAAL,CAAiBoB,MAAjB,GAA0B,KAA1B;AACA,SAAKjB,SAAL,CAAeiB,MAAf,GAAwB,KAAxB,CAdM,CAcwB;AAEjC,GA3CI;AA8CLC,EAAAA,cA9CK,4BA8CW;AAAI;AAChB,QAAIC,GAAG,GAAG,IAAIC,cAAJ,EAAV;;AACAD,IAAAA,GAAG,CAACE,kBAAJ,GAAyB,YAAY;AACjC,UAAIF,GAAG,CAACG,UAAJ,IAAkB,CAAlB,IAAwBH,GAAG,CAACI,MAAJ,IAAc,GAAd,IAAqBJ,GAAG,CAACI,MAAJ,GAAa,GAA9D,EAAoE;AAChE,YAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWP,GAAG,CAACQ,YAAf,CAAf;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAYL,QAAZ;AACH;AACJ,KALD;;AAMAL,IAAAA,GAAG,CAACW,IAAJ,CAAS,KAAT,EAAgBtC,UAAU,GAAC,iCAA3B,EAA8D,IAA9D;AACA2B,IAAAA,GAAG,CAACY,IAAJ;AACH,GAxDI;AA0DLC,EAAAA,eA1DK,6BA0DY;AACb,QAAIb,GAAG,GAAG,IAAIC,cAAJ,EAAV;;AACAD,IAAAA,GAAG,CAACE,kBAAJ,GAAyB,YAAY;AACjC,UAAIF,GAAG,CAACG,UAAJ,IAAkB,CAAlB,IAAwBH,GAAG,CAACI,MAAJ,IAAc,GAAd,IAAqBJ,GAAG,CAACI,MAAJ,GAAa,GAA9D,EAAoE;AAChE,YAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWP,GAAG,CAACQ,YAAf,CAAf,CADgE,CAEhE;AACH;AACJ,KALD;;AAMAR,IAAAA,GAAG,CAACW,IAAJ,CAAS,KAAT,EAAgBtC,UAAU,GAAC,iCAA3B,EAA8D,IAA9D;AACA2B,IAAAA,GAAG,CAACY,IAAJ;AACH,GApEI;AAsELE,EAAAA,mBAtEK,+BAsEeC,GAtEf,EAsEmB;AACpB,SAAKlC,SAAL,CAAeiB,MAAf,GAAwB,CAAC,KAAKjB,SAAL,CAAeiB,MAAxC;AACAxB,IAAAA,EAAE,CAAC0C,WAAH,CAAeC,IAAf,CAAoB,KAAKlC,mBAAzB,EAA6C,KAA7C,EAAmD,GAAnD;;AACA,QAAG,KAAKF,SAAL,CAAeiB,MAAlB,EAAyB;AACrB,WAAKjB,SAAL,CAAeqC,WAAf,CAA2BH,GAA3B;AACH;AACJ,GA5EI;AA8ELI,EAAAA,MA9EK,kBA8EEC,OA9EF,EA8EUL,GA9EV,EA8Ec;AAAG;AACpB,SAAKM,IAAL,CAAUC,cAAV,CAAyB,KAAzB,EAAgCC,OAAhC,GAA0C,EAA1C,CADiB,CAEjB;;AACEjD,IAAAA,EAAE,CAAC0C,WAAH,CAAeC,IAAf,CAAoB,KAAKhC,QAAzB,EAAkC,KAAlC,EAAwC,GAAxC,EAHe,CAIjB;AACA;AACA;AACA;AACA;;AACE,SAAKP,WAAL,CAAiB2C,IAAjB,CAAsBH,WAAtB,CAAkCH,GAAlC;AACA,SAAKrC,WAAL,CAAiB2C,IAAjB,CAAsBvB,MAAtB,GAA+B,IAA/B;AACF,SAAKpB,WAAL,CAAiB8C,QAAjB,GAA4BlD,EAAE,CAACM,KAAH,CAAS6C,QAAT,CAAkBC,aAA9C,CAXiB,CAW2C;;AAC5D,SAAKhD,WAAL,CAAiB2C,IAAjB,CAAsBM,YAAtB,CAAmCC,KAAnC,GAA2C,GAA3C;AACA,SAAKlD,WAAL,CAAiBmD,MAAjB,GAA0BT,OAAO,GAAC,iBAAlC;AACD,GA5FI;AA8FLU,EAAAA,UA9FK,wBA8FO;AAAI;AACZxD,IAAAA,EAAE,CAAC0C,WAAH,CAAeC,IAAf,CAAoB,KAAKhC,QAAzB,EAAkC,KAAlC,EAAwC,GAAxC;AACF,SAAKoC,IAAL,CAAUC,cAAV,CAAyB,KAAzB,EAAgCC,OAAhC,GAA0C,GAA1C,CAFU,CAGV;AACA;;AACE,SAAK7C,WAAL,CAAiB2C,IAAjB,CAAsBvB,MAAtB,GAA+B,KAA/B;AACH,GApGI;AAsGLiC,EAAAA,YAtGK,0BAsGS,CAAI;AAEjB,GAxGI;AA0GLC,EAAAA,KA1GK,mBA0GI;AACL,QAAG1D,EAAE,CAAC2D,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,QAA5B,KAAyC,IAA5C,EAAiD;AAC7C7D,MAAAA,EAAE,CAACgB,QAAH,CAAY8C,SAAZ,CAAsB,SAAtB;AACH;;AACD,QAAG9D,EAAE,CAAC2D,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,YAA5B,KAA6C,IAAhD,EAAqD;AACjD7D,MAAAA,EAAE,CAACgB,QAAH,CAAY8C,SAAZ,CAAsB,UAAtB;AACH;AACJ,GAjHI;AAkHLC,EAAAA,YAlHK,wBAkHQC,KAlHR,EAkHcvB,GAlHd,EAkHkB;AAAC;AACpBzC,IAAAA,EAAE,CAACgB,QAAH,CAAYiD,YAAZ,CAAyBD,KAAzB;AACA,QAAIE,MAAM,GAAC5C,MAAM,CAAC6C,UAAP,CAAkB,YAAW;AACpCnE,MAAAA,EAAE,CAACgB,QAAH,CAAY8C,SAAZ,CAAsBE,KAAtB;AACH,KAFU,EAET,IAFS,CAAX;AAGA,QAAII,UAAU,GAAGpE,EAAE,CAACqE,WAAH,CAAe,KAAKzD,OAApB,CAAjB;AACAwD,IAAAA,UAAU,CAACE,MAAX,GAAoB,KAAKvB,IAAzB;AACAqB,IAAAA,UAAU,CAACxB,WAAX,CAAuBH,GAAvB;AAEH,GA3HI,CA6HL;AACA;;AA9HK,CAAT","sourceRoot":"/","sourcesContent":["\r\nconst requestUrl = \"http://47.104.80.127:8080/\"\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        noticeLabel:{\r\n            type:cc.Label,\r\n            default:null\r\n        },\r\n        myPackage: {\r\n            type: cc.Node,\r\n            default: null\r\n        },\r\n        openAndPackageAudio:{\r\n            type:cc.AudioClip,\r\n            default:null\r\n        },\r\n        openDoor:{\r\n            type:cc.AudioClip,\r\n            default:null\r\n        },\r\n        hcs_pre:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n\r\n    },\r\n\r\n    onLoad () {\r\n        let p = cc.director.getPhysicsManager();\r\n        p.enabled = true;\r\n        p.gravity = cc.v2(0,0); \r\n        // p.debugDrawFlags = true;  //显示出来碰撞边框，为了方便演示\r\n        cc.director.getCollisionManager().enabled = true; //检测碰撞\r\n        // cc.director.getCollisionManager().enabledDebugDraw = true;//碰撞检测的边框显示\r\n\r\n        window.game = this;\r\n        // this.initialization();//游戏开始的数据初始化   网络请求\r\n        // this.queryHeroDetail();  //已经在heroDetail.js里调用\r\n\r\n        //通知提示的label初始化时active为false;\r\n        this.noticeLabel.active = false;\r\n        this.myPackage.active = false;//背包初始化不显示\r\n\r\n    },\r\n\r\n\r\n    initialization(){   //进入游戏的个人数据初始化,查背包\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                var response = JSON.parse(xhr.responseText);\r\n                console.log(response);\r\n            }\r\n        };\r\n        xhr.open(\"GET\", requestUrl+\"archives/beginGame?archivesId=1\", true);\r\n        xhr.send();\r\n    },\r\n\r\n    queryHeroDetail(){\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                var response = JSON.parse(xhr.responseText);\r\n                // console.log(response);\r\n            }\r\n        };\r\n        xhr.open(\"GET\", requestUrl+\"archives/queryArchives?userId=1\", true);\r\n        xhr.send();\r\n    },\r\n\r\n    openAndClosePackage(pos){\r\n        this.myPackage.active = !this.myPackage.active;\r\n        cc.audioEngine.play(this.openAndPackageAudio,false,0.3);\r\n        if(this.myPackage.active){\r\n            this.myPackage.setPosition(pos);\r\n        }\r\n    },\r\n\r\n    notice(message,pos){  //进入房间的提示“房间没有东西，按q退出”\r\n      this.node.getChildByName(\"map\").opacity = 30;\r\n      // this.node.getChildByName(\"hero\").opacity = 30;\r\n        cc.audioEngine.play(this.openDoor,false,0.3);\r\n      // this.node.addComponent(cc.Label);\r\n      //   let noticeLabel = this.node.getComponent(cc.Label);   //notice打算动态生成的，而不是在this.noticeLabel节点更改\r\n      //       noticeLabel.node.setPosition(pos);\r\n      //   console.log(this.noticeLabel)\r\n      //   console.log(noticeLabel)\r\n        this.noticeLabel.node.setPosition(pos);\r\n        this.noticeLabel.node.active = true;\r\n      this.noticeLabel.overflow = cc.Label.Overflow.RESIZE_HEIGHT;//自适应高度。文字越多，会扩展高度\r\n      this.noticeLabel.node._contentSize.width = 800;\r\n      this.noticeLabel.string = message+\"......  按'q'键退出\";\r\n    },\r\n\r\n    noticeExit(){   //按q键退出的处理\r\n        cc.audioEngine.play(this.openDoor,false,0.3);\r\n      this.node.getChildByName(\"map\").opacity = 255;\r\n      // this.node.getChildByName(\"hero\").opacity = 255;\r\n      // this.node.getComponent(cc.Label).destroy();\r\n        this.noticeLabel.node.active = false;\r\n    },\r\n\r\n    openKnapsack(){   //打开背包\r\n\r\n    },\r\n\r\n    start () {\r\n        if(cc.sys.localStorage.getItem(\"userId\") == null){\r\n            cc.director.loadScene(\"welcome\");\r\n        }\r\n        if(cc.sys.localStorage.getItem(\"checkPoint\") == null){\r\n            cc.director.loadScene(\"archives\");\r\n        }\r\n    },\r\n    loadNewScene(scene,pos){//在这里加传送的特效,预加载新地图，节省loading时间\r\n        cc.director.preloadScene(scene);\r\n        var timer1=window.setTimeout(function (){\r\n            cc.director.loadScene(scene);\r\n        },3000);\r\n        let herocsNode = cc.instantiate(this.hcs_pre);\r\n        herocsNode.parent = this.node;\r\n        herocsNode.setPosition(pos);\r\n\r\n    },\r\n\r\n    // update (dt) {\r\n    // },\r\n});\r\n"]}